import{s as Ll,a as D,e as r,t as z,g as k,c,b as h,p as Q,d as L,f,q as i,B as me,i as ge,h as e,j as Xe,w as hl,r as Cl,Y as Ml,n as zl,H as Tl,E as Pl,y as Hl,A as et}from"../chunks/scheduler.C9ZL8GxQ.js";import{S as Fl,i as Bl,c as Nl,b as Ol,m as Rl,t as xl,a as Ul,d as Yl}from"../chunks/index.vifww4_P.js";import{N as jl,e as ct}from"../chunks/NavigationBar.BGMdr-zL.js";import"../chunks/transform.BNP73y-7.js";import{Q as Wl,R as Rt,S as ql,t as pl,T as Gl,O as ml,U as Xl,V as Kl,W as Zl,J as xt,L as Jl,X as Ut,Y as Yt,N as gl,Z as _l}from"../chunks/index.DsTuvus7.js";import{b as Ql}from"../chunks/paths.DhqE-eXh.js";import{M as $l}from"../chunks/mapUK.Bfe54qF3.js";import{f as ea,h as ta,i as la,j as aa,k as sa,e as ft,l as dt,m as bl}from"../chunks/globals.Bwfxw-lO.js";import{g as jt,i as na,j as ia,k as oa}from"../chunks/duckdb.JsBt_f7_.js";import{p as El}from"../chunks/per_capita.COcMrZFY.js";import{n as ra}from"../chunks/nice.CBLIHRhv.js";import{t as ca,b as da}from"../chunks/bin.B6e-y8I2.js";import{d as Wt}from"../chunks/dot.D5OFD_Dj.js";var fa=Array.prototype,ua=fa.slice;function qt(t){return()=>t}function va(){var t=Wl,a=Rt,l=ca;function s(d){Array.isArray(d)||(d=Array.from(d));var n,_=d.length,u,C,I=new Array(_);for(n=0;n<_;++n)I[n]=t(d[n],n,d);var p=a(I),V=p[0],m=p[1],b=l(I,V,m);if(!Array.isArray(b)){const A=m,y=+b;if(a===Rt&&([V,m]=ra(V,m,y)),b=ql(V,m,y),b[0]<=V&&(C=pl(V,m,y)),b[b.length-1]>=m)if(A>=m&&a===Rt){const w=pl(V,m,y);isFinite(w)&&(w>0?m=(Math.floor(m/w)+1)*w:w<0&&(m=(Math.ceil(m*-w)+1)/-w))}else b.pop()}for(var g=b.length,M=0,H=g;b[M]<=V;)++M;for(;b[H-1]>m;)--H;(M||H<g)&&(b=b.slice(M,H),g=H-M);var P=new Array(g+1),S;for(n=0;n<=g;++n)S=P[n]=[],S.x0=n>0?b[n-1]:V,S.x1=n<g?b[n]:m;if(isFinite(C)){if(C>0)for(n=0;n<_;++n)(u=I[n])!=null&&V<=u&&u<=m&&P[Math.min(g,Math.floor((u-V)/C))].push(d[n]);else if(C<0){for(n=0;n<_;++n)if((u=I[n])!=null&&V<=u&&u<=m){const A=Math.floor((V-u)*C);P[Math.min(g,A+(b[A]<=u))].push(d[n])}}}else for(n=0;n<_;++n)(u=I[n])!=null&&V<=u&&u<=m&&P[Gl(b,u,0,g)].push(d[n]);return P}return s.value=function(d){return arguments.length?(t=typeof d=="function"?d:qt(d),s):t},s.domain=function(d){return arguments.length?(a=typeof d=="function"?d:qt([d[0],d[1]]),s):a},s.thresholds=function(d){return arguments.length?(l=typeof d=="function"?d:qt(Array.isArray(d)?ua.call(d):d),s):l},s}function Dl(t,a,l){const s=t.slice();return s[42]=a[l],s[43]=a,s[44]=l,s}function kl(t,a,l){const s=t.slice();return s[42]=a[l],s}function Vl(t){let a,l,s,d,n;return{c(){a=r("div"),l=r("div"),s=r("span"),d=z(t[13]),n=z(" >>"),this.h()},l(_){a=c(_,"DIV",{class:!0});var u=h(a);l=c(u,"DIV",{class:!0});var C=h(l);s=c(C,"SPAN",{class:!0});var I=h(s);d=L(I,t[13]),n=L(I," >>"),I.forEach(f),C.forEach(f),u.forEach(f),this.h()},h(){i(s,"class","mini-header-text"),i(l,"class","mini-header-content"),i(a,"class","mini-header")},m(_,u){ge(_,a,u),e(a,l),e(l,s),e(s,d),e(s,n)},p:zl,d(_){_&&f(a)}}}function Sl(t){let a,l,s=t[9].legend(t[17]).outerHTML+"";return{c(){a=r("div"),l=new Tl(!1),this.h()},l(d){a=c(d,"DIV",{id:!0});var n=h(a);l=Pl(n,!1),n.forEach(f),this.h()},h(){l.a=null,i(a,"id","legend")},m(d,n){ge(d,a,n),l.m(s,a)},p(d,n){n[0]&512&&s!==(s=d[9].legend(d[17]).outerHTML+"")&&l.p(s)},d(d){d&&f(a)}}}function Al(t){let a,l,s,d,n=t[42].def+"",_,u,C,I,p,V,m,b="here",g,M,H=t[42].id+"",P,S,A;return{c(){a=r("div"),l=r("div"),s=r("div"),d=D(),_=z(n),u=D(),C=r("br"),I=D(),p=r("div"),V=z("Click "),m=r("a"),m.textContent=b,g=z(` for the \r
                                `),M=r("span"),P=z(H),S=D(),A=z("report page."),this.h()},l(y){a=c(y,"DIV",{class:!0});var w=h(a);l=c(w,"DIV",{class:!0});var F=h(l);s=c(F,"DIV",{style:!0}),h(s).forEach(f),d=k(F),_=L(F,n),u=k(F),C=c(F,"BR",{}),I=k(F),p=c(F,"DIV",{class:!0});var B=h(p);V=L(B,"Click "),m=c(B,"A",{class:!0,href:!0,target:!0,rel:!0,style:!0,"data-svelte-h":!0}),Q(m)!=="svelte-gjrxnt"&&(m.textContent=b),g=L(B,` for the \r
                                `),M=c(B,"SPAN",{style:!0});var x=h(M);P=L(x,H),S=k(x),x.forEach(f),A=L(B,"report page."),B.forEach(f),F.forEach(f),w.forEach(f),this.h()},h(){me(s,"height","0.8em"),i(m,"class","link"),i(m,"href",Ql+"/cobenefit?cobenefit="+t[42].id),i(m,"target","_blank"),i(m,"rel","noopener noreferrer"),me(m,"color",ft(t[42].id)),me(M,"color",ft(t[42].id)),i(p,"class","link-box svelte-7z2can"),i(l,"class","legend-description svelte-7z2can"),i(a,"class","legend-description-box svelte-7z2can")},m(y,w){ge(y,a,w),e(a,l),e(l,s),e(l,d),e(l,_),e(l,u),e(l,C),e(l,I),e(l,p),e(p,V),e(p,m),e(p,g),e(p,M),e(M,P),e(M,S),e(p,A)},d(y){y&&f(a)}}}function yl(t){let a,l,s,d,n,_=t[42].label+"",u,C,I,p=t[12].has(t[42].id)?"▲":"▼",V,m,b=t[12].has(t[42].id),g,M,H;function P(){return t[24](t[42])}let S=b&&Al(t);return{c(){a=r("div"),l=r("div"),s=r("span"),d=D(),n=r("span"),u=z(_),C=D(),I=r("span"),V=z(p),m=D(),S&&S.c(),g=D(),this.h()},l(A){a=c(A,"DIV",{class:!0});var y=h(a);l=c(y,"DIV",{class:!0,style:!0});var w=h(l);s=c(w,"SPAN",{class:!0,style:!0}),h(s).forEach(f),d=k(w),n=c(w,"SPAN",{class:!0});var F=h(n);u=L(F,_),F.forEach(f),C=k(w),I=c(w,"SPAN",{class:!0});var B=h(I);V=L(B,p),B.forEach(f),w.forEach(f),m=k(y),S&&S.l(y),g=k(y),y.forEach(f),this.h()},h(){i(s,"class","legend-color svelte-7z2can"),me(s,"background-color",ft(t[42].id)),i(n,"class","legend-text svelte-7z2can"),i(I,"class","toggle-icon svelte-7z2can"),i(l,"class","legend-header svelte-7z2can"),me(l,"cursor","pointer"),i(a,"class","legend-item svelte-7z2can")},m(A,y){ge(A,a,y),e(a,l),e(l,s),e(l,d),e(l,n),e(n,u),e(l,C),e(l,I),e(I,V),e(a,m),S&&S.m(a,null),e(a,g),M||(H=Hl(l,"click",P),M=!0)},p(A,y){t=A,y[0]&4096&&p!==(p=t[12].has(t[42].id)?"▲":"▼")&&Xe(V,p),y[0]&4096&&(b=t[12].has(t[42].id)),b?S||(S=Al(t),S.c(),S.m(a,g)):S&&(S.d(1),S=null)},d(A){A&&f(a),S&&S.d(),M=!1,H()}}}function Il(t){let a=console.log("Missing key in plotSmallMult:",t[42].id)+"",l;return{c(){l=z(a)},l(s){l=L(s,a)},m(s,d){ge(s,l,d)},p:zl,d(s){s&&f(l)}}}function wl(t){let a,l,s=t[42].label+"",d,n,_,u,C=t[42],I,p=t[0][t[42].id]===void 0&&Il(t);const V=()=>t[25](u,C),m=()=>t[25](null,C);return{c(){a=r("div"),l=r("h3"),d=z(s),n=D(),p&&p.c(),_=D(),u=r("div"),I=D(),this.h()},l(b){a=c(b,"DIV",{class:!0});var g=h(a);l=c(g,"H3",{class:!0});var M=h(l);d=L(M,s),M.forEach(f),n=k(g),p&&p.l(g),_=k(g),u=c(g,"DIV",{class:!0}),h(u).forEach(f),I=k(g),g.forEach(f),this.h()},h(){i(l,"class","component-chart-title svelte-7z2can"),i(u,"class","plot svelte-7z2can"),i(a,"class","plot-container svelte-7z2can")},m(b,g){ge(b,a,g),e(a,l),e(l,d),e(a,n),p&&p.m(a,null),e(a,_),e(a,u),V(),e(a,I)},p(b,g){t=b,t[0][t[42].id]===void 0?p?p.p(t,g):(p=Il(t),p.c(),p.m(a,_)):p&&(p.d(1),p=null),C!==t[42]&&(m(),C=t[42],V())},d(b){b&&f(a),p&&p.d(),m()}}}function ha(t){let a,l,s,d,n,_,u,C="SEF Report",I,p,V,m,b,g,M,H,P,S,A,y,w,F,B,x=Ge(t[5],t[16])+"",se,ne,_e,Ke,ie,te,Ze,oe,be=Ge(t[4],t[16])+"",$,He,X,Je,Ee,De=Ge(t[6],t[16])+"",Fe,Qe,o,W,U,ke,re,Gt='<div class="radio-set svelte-7z2can">Select which level of data you&#39;d like to view:<br/> <input type="radio" name="compare" value="LSOA" checked=""/> <label class="nation-label svelte-7z2can" for="html">Data Zone (LSOA)</label><br/> <input type="radio" name="compare" value="LAD"/> <label class="nation-label svelte-7z2can" for="html">Local Authority (LAD)</label><br/></div>',ut,Be,ce,Ve,Xt='<p class="section-subtitle svelte-7z2can">Overview</p>',vt,le,K,Se,ht,pt,mt,Ae,Kt="Each point in the chart below represents a UK data zone (LSOA).",gt,ye,Zt=`<div class="tooltip-wrapper"><img class="aggregation-icon" src="${El}" alt="icon"/> <span class="tooltip-text">This chart uses per capita values. i.e. shows the cost/benefit per person in each AREA.</span></div>`,_t,Ne,bt,q,Oe,Et,Dt,Ie,Jt="Scroll for zooming in and out.",kt,tt,we,Vt,de,ze,Qt='<p class="section-subtitle svelte-7z2can">By Co-benefits</p>',St,ee,N,fe,At,$t=t[13].toLowerCase()+"",yt,It,wt,Le,el="Each plot shows the distribution of benefits or costs depending on a given co-benefit.",zt,Ce,tl=`<div class="tooltip-wrapper"><img class="aggregation-icon" src="${El}" alt="icon"/> <span class="tooltip-text">These charts use per capita values. i.e. show the cost/benefit per person in each LAD.</span></div>`,Lt,Ct,Mt,ue,ll='<p style="margin: 0 0 1rem 0;"><strong>Correlation ≠ Causation:</strong> The scatter plots represent modelled associations and should not be interpreted as direct causal relationships.</p>',Tt,G,Re,al="Co-benefits:",Pt,Ht,$e,Ft,Bt,Me,ve,ae;a=new jl({});let Y=t[11]&&Vl(t),j=t[9]&&Sl(t),xe=ct(dt),O=[];for(let v=0;v<xe.length;v+=1)O[v]=yl(kl(t,xe,v));let Ue=ct(dt),R=[];for(let v=0;v<Ue.length;v+=1)R[v]=wl(Dl(t,Ue,v));return{c(){Nl(a.$$.fragment),l=D(),s=r("div"),d=r("div"),n=r("div"),_=r("div"),u=r("p"),u.textContent=C,I=D(),p=r("div"),V=r("h1"),m=z(t[15]),b=D(),g=r("p"),M=z(t[14]),H=D(),P=r("div"),S=r("div"),A=D(),y=r("div"),w=r("p"),F=z("Max value: "),B=r("strong"),se=z(x),ne=z(`\r
                    (`),_e=z(t[7]),Ke=z(")"),ie=D(),te=r("p"),Ze=z("Average value: "),oe=r("strong"),$=z(be),He=D(),X=r("p"),Je=z("Min value: "),Ee=r("strong"),Fe=z(De),Qe=z(`\r
                    (`),o=z(t[8]),W=z(")"),U=D(),Y&&Y.c(),ke=D(),re=r("div"),re.innerHTML=Gt,ut=D(),Be=r("div"),ce=r("div"),Ve=r("div"),Ve.innerHTML=Xt,vt=D(),le=r("div"),K=r("div"),Se=r("h3"),ht=z(t[13]),pt=z(" against per capita co-benefit values (£, thousand)"),mt=D(),Ae=r("p"),Ae.textContent=Kt,gt=D(),ye=r("div"),ye.innerHTML=Zt,_t=D(),Ne=r("div"),bt=D(),q=r("div"),Oe=r("h3"),Et=z(t[13]),Dt=D(),Ie=r("p"),Ie.textContent=Jt,kt=D(),j&&j.c(),tt=D(),we=r("div"),Vt=D(),de=r("div"),ze=r("div"),ze.innerHTML=Qt,St=D(),ee=r("div"),N=r("div"),fe=r("h3"),At=z("Plotting "),yt=z($t),It=z(" against the gain/loss (£, thousand) per capita for each co-benefit"),wt=D(),Le=r("p"),Le.textContent=el,zt=D(),Ce=r("div"),Ce.innerHTML=tl,Lt=D(),Ct=r("br"),Mt=D(),ue=r("div"),ue.innerHTML=ll,Tt=D(),G=r("div"),Re=r("strong"),Re.textContent=al,Pt=r("br"),Ht=z(`Expand for detailed information\r
                    `),$e=r("div"),Ft=D();for(let v=0;v<O.length;v+=1)O[v].c();Bt=D(),Me=r("div"),ve=r("div");for(let v=0;v<R.length;v+=1)R[v].c();this.h()},l(v){Ol(a.$$.fragment,v),l=k(v),s=c(v,"DIV",{class:!0});var T=h(s);d=c(T,"DIV",{class:!0});var E=h(d);n=c(E,"DIV",{class:!0});var Z=h(n);_=c(Z,"DIV",{class:!0});var lt=h(_);u=c(lt,"P",{class:!0,"data-svelte-h":!0}),Q(u)!=="svelte-3h7aqf"&&(u.textContent=C),I=k(lt),p=c(lt,"DIV",{class:!0});var at=h(p);V=c(at,"H1",{class:!0});var sl=h(V);m=L(sl,t[15]),sl.forEach(f),b=k(at),g=c(at,"P",{class:!0});var nl=h(g);M=L(nl,t[14]),nl.forEach(f),at.forEach(f),lt.forEach(f),H=k(Z),P=c(Z,"DIV",{class:!0});var il=h(P);S=c(il,"DIV",{class:!0}),h(S).forEach(f),il.forEach(f),A=k(Z),y=c(Z,"DIV",{class:!0});var Ye=h(y);w=c(Ye,"P",{class:!0});var je=h(w);F=L(je,"Max value: "),B=c(je,"STRONG",{});var ol=h(B);se=L(ol,x),ol.forEach(f),ne=L(je,`\r
                    (`),_e=L(je,t[7]),Ke=L(je,")"),je.forEach(f),ie=k(Ye),te=c(Ye,"P",{class:!0});var Nt=h(te);Ze=L(Nt,"Average value: "),oe=c(Nt,"STRONG",{style:!0});var rl=h(oe);$=L(rl,be),rl.forEach(f),Nt.forEach(f),He=k(Ye),X=c(Ye,"P",{class:!0});var We=h(X);Je=L(We,"Min value: "),Ee=c(We,"STRONG",{});var cl=h(Ee);Fe=L(cl,De),cl.forEach(f),Qe=L(We,`\r
                    (`),o=L(We,t[8]),W=L(We,")"),We.forEach(f),Ye.forEach(f),Z.forEach(f),E.forEach(f),U=k(T),Y&&Y.l(T),ke=k(T),re=c(T,"DIV",{class:!0,"data-svelte-h":!0}),Q(re)!=="svelte-1paauel"&&(re.innerHTML=Gt),ut=k(T),Be=c(T,"DIV",{class:!0});var dl=h(Be);ce=c(dl,"DIV",{id:!0});var st=h(ce);Ve=c(st,"DIV",{class:!0,"data-svelte-h":!0}),Q(Ve)!=="svelte-ll1i43"&&(Ve.innerHTML=Xt),vt=k(st),le=c(st,"DIV",{id:!0,class:!0});var nt=h(le);K=c(nt,"DIV",{class:!0});var he=h(K);Se=c(he,"H3",{class:!0});var Ot=h(Se);ht=L(Ot,t[13]),pt=L(Ot," against per capita co-benefit values (£, thousand)"),Ot.forEach(f),mt=k(he),Ae=c(he,"P",{class:!0,"data-svelte-h":!0}),Q(Ae)!=="svelte-1ozkrs5"&&(Ae.textContent=Kt),gt=k(he),ye=c(he,"DIV",{class:!0,"data-svelte-h":!0}),Q(ye)!=="svelte-xpsz06"&&(ye.innerHTML=Zt),_t=k(he),Ne=c(he,"DIV",{class:!0}),h(Ne).forEach(f),he.forEach(f),bt=k(nt),q=c(nt,"DIV",{class:!0});var pe=h(q);Oe=c(pe,"H3",{class:!0});var fl=h(Oe);Et=L(fl,t[13]),fl.forEach(f),Dt=k(pe),Ie=c(pe,"P",{class:!0,"data-svelte-h":!0}),Q(Ie)!=="svelte-1ask2se"&&(Ie.textContent=Jt),kt=k(pe),j&&j.l(pe),tt=k(pe),we=c(pe,"DIV",{id:!0,class:!0}),h(we).forEach(f),pe.forEach(f),nt.forEach(f),st.forEach(f),dl.forEach(f),Vt=k(T),de=c(T,"DIV",{id:!0});var it=h(de);ze=c(it,"DIV",{class:!0,"data-svelte-h":!0}),Q(ze)!=="svelte-1av3fse"&&(ze.innerHTML=Qt),St=k(it),ee=c(it,"DIV",{id:!0,class:!0,style:!0});var ot=h(ee);N=c(ot,"DIV",{id:!0,class:!0});var J=h(N);fe=c(J,"H3",{class:!0});var rt=h(fe);At=L(rt,"Plotting "),yt=L(rt,$t),It=L(rt," against the gain/loss (£, thousand) per capita for each co-benefit"),rt.forEach(f),wt=k(J),Le=c(J,"P",{class:!0,"data-svelte-h":!0}),Q(Le)!=="svelte-1iwsgx4"&&(Le.textContent=el),zt=k(J),Ce=c(J,"DIV",{class:!0,"data-svelte-h":!0}),Q(Ce)!=="svelte-z8l5xy"&&(Ce.innerHTML=tl),Lt=k(J),Ct=c(J,"BR",{}),Mt=k(J),ue=c(J,"DIV",{id:!0,class:!0,"data-svelte-h":!0}),Q(ue)!=="svelte-vpijtr"&&(ue.innerHTML=ll),Tt=k(J),G=c(J,"DIV",{id:!0,class:!0});var Te=h(G);Re=c(Te,"STRONG",{"data-svelte-h":!0}),Q(Re)!=="svelte-1qu96kx"&&(Re.textContent=al),Pt=c(Te,"BR",{}),Ht=L(Te,`Expand for detailed information\r
                    `),$e=c(Te,"DIV",{style:!0}),h($e).forEach(f),Ft=k(Te);for(let Pe=0;Pe<O.length;Pe+=1)O[Pe].l(Te);Te.forEach(f),J.forEach(f),Bt=k(ot),Me=c(ot,"DIV",{id:!0,class:!0});var ul=h(Me);ve=c(ul,"DIV",{id:!0,class:!0});var vl=h(ve);for(let Pe=0;Pe<R.length;Pe+=1)R[Pe].l(vl);vl.forEach(f),ul.forEach(f),ot.forEach(f),it.forEach(f),T.forEach(f),this.h()},h(){i(u,"class","page-subtitle svelte-7z2can"),i(V,"class","page-title svelte-7z2can"),i(g,"class","definition"),i(p,"class","title-container"),i(_,"class","header-text svelte-7z2can"),i(S,"class","plot svelte-7z2can"),i(P,"class","header-vis svelte-7z2can"),i(w,"class","definition-stat svelte-7z2can"),me(oe,"color","#BD210E"),i(te,"class","definition-stat svelte-7z2can"),i(X,"class","definition-stat svelte-7z2can"),i(y,"class","header-stats svelte-7z2can"),i(n,"class","header-content svelte-7z2can"),i(d,"class","section header svelte-7z2can"),i(re,"class","section"),i(Ve,"class","section-header"),i(Se,"class","component-title"),i(Ae,"class","description"),i(ye,"class","aggregation-icon-container"),i(Ne,"class","plot-dot svelte-7z2can"),i(K,"class","component column"),i(Oe,"class","component-title"),i(Ie,"class","description"),i(we,"id","map"),i(we,"class","svelte-7z2can"),i(q,"class","component column"),i(le,"id","vis-block"),i(le,"class","svelte-7z2can"),i(ce,"id","overview"),i(Be,"class","section"),i(ze,"class","section-header"),i(fe,"class","component-title"),i(Le,"class","explanation"),i(Ce,"class","aggregation-icon-container2 svelte-7z2can"),i(ue,"id","se-disclaimer"),i(ue,"class","disclaimer-box"),me($e,"height","0.8em"),i(G,"id","main-legend"),i(G,"class","legend-box svelte-7z2can"),i(N,"id","se-title"),i(N,"class","svelte-7z2can"),i(ve,"id","multiple-plots"),i(ve,"class","svelte-7z2can"),i(Me,"id","multiple-comp"),i(Me,"class","svelte-7z2can"),i(ee,"id","se-block"),i(ee,"class","component svelte-7z2can"),me(ee,"margin-left","1rem"),i(de,"id","compare"),i(s,"class","page-container")},m(v,T){Rl(a,v,T),ge(v,l,T),ge(v,s,T),e(s,d),e(d,n),e(n,_),e(_,u),e(_,I),e(_,p),e(p,V),e(V,m),e(p,b),e(p,g),e(g,M),e(n,H),e(n,P),e(P,S),t[21](S),e(n,A),e(n,y),e(y,w),e(w,F),e(w,B),e(B,se),e(w,ne),e(w,_e),e(w,Ke),e(y,ie),e(y,te),e(te,Ze),e(te,oe),e(oe,$),e(y,He),e(y,X),e(X,Je),e(X,Ee),e(Ee,Fe),e(X,Qe),e(X,o),e(X,W),e(s,U),Y&&Y.m(s,null),e(s,ke),e(s,re),e(s,ut),e(s,Be),e(Be,ce),e(ce,Ve),e(ce,vt),e(ce,le),e(le,K),e(K,Se),e(Se,ht),e(Se,pt),e(K,mt),e(K,Ae),e(K,gt),e(K,ye),e(K,_t),e(K,Ne),t[22](Ne),e(le,bt),e(le,q),e(q,Oe),e(Oe,Et),e(q,Dt),e(q,Ie),e(q,kt),j&&j.m(q,null),e(q,tt),e(q,we),t[23](we),e(s,Vt),e(s,de),e(de,ze),e(de,St),e(de,ee),e(ee,N),e(N,fe),e(fe,At),e(fe,yt),e(fe,It),e(N,wt),e(N,Le),e(N,zt),e(N,Ce),e(N,Lt),e(N,Ct),e(N,Mt),e(N,ue),e(N,Tt),e(N,G),e(G,Re),e(G,Pt),e(G,Ht),e(G,$e),e(G,Ft);for(let E=0;E<O.length;E+=1)O[E]&&O[E].m(G,null);e(ee,Bt),e(ee,Me),e(Me,ve);for(let E=0;E<R.length;E+=1)R[E]&&R[E].m(ve,null);t[26](s),ae=!0},p(v,T){if((!ae||T[0]&32)&&x!==(x=Ge(v[5],v[16])+"")&&Xe(se,x),(!ae||T[0]&128)&&Xe(_e,v[7]),(!ae||T[0]&16)&&be!==(be=Ge(v[4],v[16])+"")&&Xe($,be),(!ae||T[0]&64)&&De!==(De=Ge(v[6],v[16])+"")&&Xe(Fe,De),(!ae||T[0]&256)&&Xe(o,v[8]),v[11]?Y?Y.p(v,T):(Y=Vl(v),Y.c(),Y.m(s,ke)):Y&&(Y.d(1),Y=null),v[9]?j?j.p(v,T):(j=Sl(v),j.c(),j.m(q,tt)):j&&(j.d(1),j=null),T[0]&266240){xe=ct(dt);let E;for(E=0;E<xe.length;E+=1){const Z=kl(v,xe,E);O[E]?O[E].p(Z,T):(O[E]=yl(Z),O[E].c(),O[E].m(G,null))}for(;E<O.length;E+=1)O[E].d(1);O.length=xe.length}if(T[0]&1){Ue=ct(dt);let E;for(E=0;E<Ue.length;E+=1){const Z=Dl(v,Ue,E);R[E]?R[E].p(Z,T):(R[E]=wl(Z),R[E].c(),R[E].m(ve,null))}for(;E<R.length;E+=1)R[E].d(1);R.length=Ue.length}},i(v){ae||(xl(a.$$.fragment,v),ae=!0)},o(v){Ul(a.$$.fragment,v),ae=!1},d(v){v&&(f(l),f(s)),Yl(a,v),t[21](null),Y&&Y.d(),t[22](null),j&&j.d(),t[23](null),hl(O,v),hl(R,v),t[26](null)}}}let qe=400;function Ge(t,a){return a==="£"?`${a}${t}`:`${t} ${a}`}function pa(t,a,l){let s,d,n,_={},u,C,I,p=!1,V,m,b,g,M,H,P,{data:S}=a;const A=S.SEF;console.log("SEF ",A);const y=ea.find(o=>o.id===A)?.label??A,w=ta.find(o=>o.id===A)?.def??A,F=la.find(o=>o.id===A)?.description??A,B=aa.find(o=>o.id===A)?.short_units??A,x=sa.find(o=>o.id===A)?.units??A;let se,ne,_e=!1;const Ke=["overview","compare"];function ie(){const o=window.scrollY;l(11,_e=o>250);for(const W of Ke){const U=document.getElementById(W);if(!U)continue;const ke=U.getBoundingClientRect();if(ke.top<=150&&ke.bottom>=150)break}}Cl(()=>(window.addEventListener("scroll",ie),ie(),()=>window.removeEventListener("scroll",ie))),Ml(()=>{window.removeEventListener("scroll",ie)});async function te(){u=await jt(na(A)),console.log("totals",u),C=await jt(ia(A)),console.log("by cobens",C),I=await jt(oa()),console.log("per_capita_data",I),l(4,V=(ml(u,o=>o.val)??0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),console.log("Average Value: ",V),M=Xl(u,o=>o.val),l(7,g=M!==-1?u[M].Lookup_Value:"N/A"),l(5,m=(u[M]?.val??0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),P=Kl(u,o=>o.val),l(8,H=P!==-1?u[P].Lookup_Value:"N/A"),l(6,b=(u[P]?.val??0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),bl.forEach(o=>{C[o]=+C[o]}),l(20,p=!0)}te().then(()=>{l(9,se=new $l(u,"LSOA",ne,"val",!1,"Lookup_Value",!1)),se.initMap()});function Ze(){const o=ml(u,U=>U.val)??0,W=Zl(va().thresholds(20).value(U=>U.val)(u),U=>U.length);d?.append(xt({height:qe/1.9,width:qe*1.7,marginLeft:60,marginTop:30,marginRight:20,marginBottom:50,x:{label:`${x}`},y:{label:"No. of datazones/LADs",labelArrow:!1},style:{fontSize:"16px"},marks:[Jl(u,da({y:"count"},{x:{value:"val",thresholds:20},fill:"black",fillOpacity:.5,stroke:"black",srokeWidth:5})),Ut([o],{stroke:"#BD210E",strokeWidth:4,channels:{average:{value:o,label:"Average"}},tip:{format:{average:U=>`${U.toFixed(2)}`,x:!1}}}),Wt(u,{x:{value:o,thresholds:20},y:W+.1*W,r:5,fill:"#BD210E"}),Yt({label:`${x}`,labelArrow:!1,labelAnchor:"center"})]}))}function oe(){n?.append(xt({height:qe*1.5,width:qe*2,marginLeft:60,marginTop:60,marginRight:10,marginBottom:60,x:{grid:!1},y:{grid:!0},style:{fontSize:"16px"},marks:[gl([0],{stroke:"#333",strokeWidth:1.25}),Ut([0],{stroke:"#333",strokeWidth:.75}),Wt(u,{x:"val",y:o=>o.total_per_capita*1e3,fill:o=>o.total_per_capita<0?"#BD210E":"#242424",r:.9,fillOpacity:.75,channels:{location:{value:"Lookup_Value",label:"Location"},sef:{value:"val",label:`${x}`},value:{value:o=>o.total_per_capita*1e3,label:"Per Capita Co-Benefit Value (£, thousand)"}},tip:{format:{location:!0,sef:!0,value:!0,x:!1,y:!1}}}),_l({label:"Per capita co-benefit value (£, thousand)",labelArrow:!1,labelAnchor:"center"}),Yt({label:`${x}`,labelArrow:!1,labelAnchor:"center"})]}))}function be(){bl.forEach(o=>{let W;W=xt({height:qe,width:qe,marginLeft:60,marginTop:10,marginRight:10,marginBottom:60,x:{label:null},y:{label:null},style:{fontSize:"16px"},marks:[gl([0],{stroke:"#333",strokeWidth:1.25}),Ut([0],{stroke:"#333",strokeWidth:.75}),Wt(C.filter(U=>U.co_benefit_type==o),{x:"val",y:"total",fill:ft(o),fillOpacity:.5,tip:!0,r:.5}),_l({label:"Per capita co-benefit value (£, thousand)",labelArrow:!1,labelAnchor:"center"}),Yt({label:`${x}`,labelArrow:!1,labelAnchor:"center"})]}),_[o]?.append(W)})}let $=new Set;function He(o){$.has(o)?$.delete(o):$.add(o),l(12,$=new Set($))}function X(o){et[o?"unshift":"push"](()=>{d=o,l(2,d)})}function Je(o){et[o?"unshift":"push"](()=>{n=o,l(3,n)})}function Ee(o){et[o?"unshift":"push"](()=>{ne=o,l(10,ne)})}const De=o=>He(o.id);function Fe(o,W){et[o?"unshift":"push"](()=>{_[W.id]=o,l(0,_)})}function Qe(o){et[o?"unshift":"push"](()=>{s=o,l(1,s)})}return t.$$set=o=>{"data"in o&&l(19,S=o.data)},t.$$.update=()=>{t.$$.dirty[0]&1048577&&(Object.values(_).forEach(o=>{o.firstChild?.remove()}),p&&(Ze(),oe(),be()))},[_,s,d,n,V,m,b,g,H,se,ne,_e,$,y,w,F,B,x,He,S,p,X,Je,Ee,De,Fe,Qe]}class za extends Fl{constructor(a){super(),Bl(this,a,pa,ha,Ll,{data:19},null,[-1,-1])}}export{za as component};
