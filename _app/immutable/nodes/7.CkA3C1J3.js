import{s as Dt,n as gt,r as It,o as Lt,d as lt}from"../chunks/scheduler.CYrT1uMS.js";import{S as Ft,i as Tt,e as c,t as Y,s as I,c as h,a as S,b as G,d as g,f as L,m as U,n as u,g as Ct,h as e,o as _t,p as At}from"../chunks/index.E94wl68j.js";import{e as bt}from"../chunks/each.-gASlQSi.js";import"../chunks/transform.Cz5Y6iUM.js";import{i as J,r as Et,j as rt,k as Vt,l as yt,n as St}from"../chunks/index.CbJWhmk4.js";import{M as zt}from"../chunks/map.C5IZ1oIR.js";import{S as st,a as Bt,M as Ht}from"../chunks/globals.5lHjyW26.js";import{b as Pt,a as ot,d as Mt,e as wt}from"../chunks/bar.Czf8fWyt.js";import{l as Rt}from"../chunks/link.D3PWXc8h.js";function kt(n,a,l){const r=n.slice();return r[17]=a[l],r[18]=a,r[19]=l,r}function xt(n){let a,l="",r=n[17];const f=()=>n[8](a,r),_=()=>n[8](null,r);return{c(){a=c("div"),a.innerHTML=l,this.h()},l(o){a=h(o,"DIV",{class:!0,"data-svelte-h":!0}),U(a)!=="svelte-18okkjt"&&(a.innerHTML=l),this.h()},h(){u(a,"class","plot")},m(o,b){Ct(o,a,b),f()},p(o,b){n=o,r!==n[17]&&(_(),r=n[17],f())},d(o){o&&g(a),_()}}}function jt(n){let a,l,r,f,_,o,b,k,F,T,E,s,A,j,q,N,M,O,x,t="Barchart",C,d,B,Q,H,dt="Distribution",Z,P,V,ct="",$,D,w,ht="Socio Economic Factors",tt,z,et,ut,R=bt(st),p=[];for(let m=0;m<R.length;m+=1)p[m]=xt(kt(n,R,m));return{c(){a=c("div"),l=c("div"),r=c("h1"),f=Y(n[3]),_=I(),o=c("p"),b=Y(n[3]),k=Y(" is ..."),F=I(),T=c("div"),E=c("div"),s=c("div"),A=c("h3"),j=Y(n[3]),q=Y(" datazone distribution"),N=I(),M=c("input"),O=I(),x=c("label"),x.textContent=t,C=c("br"),d=I(),B=c("input"),Q=I(),H=c("label"),H.textContent=dt,Z=I(),P=c("div"),V=c("div"),V.innerHTML=ct,$=I(),D=c("div"),w=c("h3"),w.textContent=ht,tt=I(),z=c("div");for(let m=0;m<p.length;m+=1)p[m].c();this.h()},l(m){a=h(m,"DIV",{class:!0});var y=S(a);l=h(y,"DIV",{class:!0});var i=S(l);r=h(i,"H1",{});var X=S(r);f=G(X,n[3]),X.forEach(g),_=L(i),o=h(i,"P",{});var at=S(o);b=G(at,n[3]),k=G(at," is ..."),at.forEach(g),i.forEach(g),F=L(y),T=h(y,"DIV",{class:!0});var pt=S(T);E=h(pt,"DIV",{id:!0,class:!0});var mt=S(E);s=h(mt,"DIV",{class:!0});var v=S(s);A=h(v,"H3",{});var nt=S(A);j=G(nt,n[3]),q=G(nt," datazone distribution"),nt.forEach(g),N=L(v),M=h(v,"INPUT",{type:!0,name:!0}),O=L(v),x=h(v,"LABEL",{for:!0,"data-svelte-h":!0}),U(x)!=="svelte-1hwbt9c"&&(x.textContent=t),C=h(v,"BR",{}),d=L(v),B=h(v,"INPUT",{type:!0,name:!0}),Q=L(v),H=h(v,"LABEL",{for:!0,"data-svelte-h":!0}),U(H)!=="svelte-27dm33"&&(H.textContent=dt),Z=L(v),P=h(v,"DIV",{class:!0});var ft=S(P);V=h(ft,"DIV",{class:!0,"data-svelte-h":!0}),U(V)!=="svelte-1nzb2m5"&&(V.innerHTML=ct),ft.forEach(g),v.forEach(g),mt.forEach(g),pt.forEach(g),$=L(y),D=h(y,"DIV",{id:!0,class:!0});var W=S(D);w=h(W,"H3",{"data-svelte-h":!0}),U(w)!=="svelte-zqlelw"&&(w.textContent=ht),tt=L(W),z=h(W,"DIV",{id:!0,class:!0});var vt=S(z);for(let it=0;it<p.length;it+=1)p[it].l(vt);vt.forEach(g),W.forEach(g),y.forEach(g),this.h()},h(){u(l,"class","section header"),u(M,"type","radio"),u(M,"name","visType"),M.value="barchart",M.checked=!0,u(x,"for","html"),u(B,"type","radio"),u(B,"name","visType"),B.value="distribution",u(H,"for","javascript"),u(V,"class","plot"),u(P,"class","component row"),u(s,"class","component singlevis"),u(E,"id","vis-block"),u(E,"class","svelte-1pbci0m"),u(T,"class","section"),u(z,"id","multiple-plots"),u(z,"class","svelte-1pbci0m"),u(D,"id","multiple-comp"),u(D,"class","component svelte-1pbci0m"),u(a,"class","page-container")},m(m,y){Ct(m,a,y),e(a,l),e(l,r),e(r,f),e(l,_),e(l,o),e(o,b),e(o,k),e(a,F),e(a,T),e(T,E),e(E,s),e(s,A),e(A,j),e(A,q),e(s,N),e(s,M),e(s,O),e(s,x),e(s,C),e(s,d),e(s,B),e(s,Q),e(s,H),e(s,Z),e(s,P),e(P,V),n[7](V),e(a,$),e(a,D),e(D,w),e(D,tt),e(D,z);for(let i=0;i<p.length;i+=1)p[i]&&p[i].m(z,null);n[9](a),et||(ut=[_t(M,"change",n[4]),_t(B,"change",n[4])],et=!0)},p(m,[y]){if(y&2){R=bt(st);let i;for(i=0;i<R.length;i+=1){const X=kt(m,R,i);p[i]?p[i].p(X,y):(p[i]=xt(X),p[i].c(),p[i].m(z,null))}for(;i<p.length;i+=1)p[i].d(1);p.length=R.length}},i:gt,o:gt,d(m){m&&g(a),n[7](null),At(p,m),n[9](null),et=!1,It(ut)}}}let K=400;function qt(n,a,l){let r,f,_={},o="barchart",{data:b}=a;const k=b.data,F=b.SEFData,T=b.coBenefit;let E,s,A;Lt(()=>{E=new zt(k,"LSOA",s,"total"),E.initMap();let t=E.legend();A.append(t)});function j(){o=="barchart"?f?.append(J({height:K/1.4,...Ht,y:{type:"band"},style:{fontSize:"18px"},marks:[wt(k,yt({x:"mean"},{x:"total",y:"scenario"})),Rt(k,yt({x1:t=>rt(t)-St(t),x2:t=>rt(t)+St(t)},{x:"total",y:"scenario",stroke:"gray",strokeWidth:3}))]})):o=="distribution"&&f?.append(J({height:K/1.4,marginLeft:60,marginRight:60,y:{label:"Datazones Frequency"},style:{fontSize:"18px"},facet:{data:k,y:"scenario"},marks:[Mt(k,ot({y:"count"},{x:"total",tip:!0}))]}))}function q(){st.forEach(t=>{let C;Bt.includes(t)?C=J({height:K/2,width:330,marginLeft:80,marginBottom:60,marginRight:30,marginTop:60,y:{grid:!0,label:"mean value (£)"},x:{grid:!0,label:t,type:"band",tickFormat:d=>Math.floor(d)},style:{fontSize:"18px"},color:{legend:!0},marks:[Pt(F.filter(d=>d.SEFMAME==t),ot({y:"mean"},{x:d=>Math.floor(d.SE).toString(),y:"total"}))]}):C=J({height:K/2,width:330,marginLeft:80,marginBottom:60,marginRight:30,marginTop:60,y:{grid:!0,label:"mean value (£)"},x:{grid:!0,label:t},style:{fontSize:"18px"},color:{legend:!0},marks:[Mt(F.filter(d=>d.SEFMAME==t),ot({y:"mean"},{x:"SE",y:"total"})),Et([rt(F.filter(d=>d.SEFMAME==t).map(d=>d.SE))],{stroke:"red"}),Et([Vt(F.filter(d=>d.SEFMAME==t).map(d=>d.SE))],{stroke:"blue"})]}),_[t]?.append(C)})}function N(t){l(6,o=t.currentTarget.value)}function M(t){lt[t?"unshift":"push"](()=>{f=t,l(0,f)})}function O(t,C){lt[t?"unshift":"push"](()=>{_[C]=t,l(1,_)})}function x(t){lt[t?"unshift":"push"](()=>{r=t,l(2,r)})}return n.$$set=t=>{"data"in t&&l(5,b=t.data)},n.$$.update=()=>{n.$$.dirty&67&&(f?.firstChild?.remove(),Object.values(_).forEach(t=>{t.firstChild?.remove()}),j(),q())},[f,_,r,T,N,b,o,M,O,x]}class Qt extends Ft{constructor(a){super(),Tt(this,a,qt,jt,Dt,{data:5})}}export{Qt as component};
