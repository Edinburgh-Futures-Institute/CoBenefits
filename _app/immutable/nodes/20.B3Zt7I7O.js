import{s as Cl,a as k,e as o,t as y,g as V,c as r,b as v,p as Z,d as I,f,q as i,B as ee,i as me,h as e,j as Ke,w as ml,r as Ml,Y as Tl,n as Ll,H as Pl,E as Hl,y as Fl,A as tt}from"../chunks/scheduler.C9ZL8GxQ.js";import{S as Nl,i as Bl,c as Rl,b as Ol,m as Ul,t as Yl,a as Wl,d as jl}from"../chunks/index.vifww4_P.js";import{N as ql,e as dt}from"../chunks/NavigationBar.DFX2jRvL.js";import"../chunks/transform.BNP73y-7.js";import{Q as Gl,R as Ot,S as Xl,t as _l,T as Kl,O as bl,U as Jl,V as Ql,W as Zl,J as Ut,L as $l,X as Yt,Y as Wt,N as El,Z as wl}from"../chunks/index.Dv2sX5N1.js";import{b as ea}from"../chunks/paths.Cq_ELSMS.js";import{M as ta}from"../chunks/mapUK.DSbeBHry.js";import{f as la,h as aa,i as sa,j as na,k as ia,e as ut,l as ft,m as Dl}from"../chunks/globals.C08mzBm5.js";import{g as jt,i as oa,j as ra,k as ca}from"../chunks/duckdb.CFVeiQtA.js";import{p as qt}from"../chunks/per_capita.COcMrZFY.js";import{n as da}from"../chunks/nice.C8A-NMIE.js";import{t as fa,b as ua}from"../chunks/bin.DlqcRK9K.js";import{d as Gt}from"../chunks/dot.nz9-EEYJ.js";var ha=Array.prototype,va=ha.slice;function Xt(t){return()=>t}function pa(){var t=Gl,a=Ot,l=fa;function n(d){Array.isArray(d)||(d=Array.from(d));var s,b=d.length,u,S,L=new Array(b);for(s=0;s<b;++s)L[s]=t(d[s],s,d);var p=a(L),E=p[0],g=p[1],w=l(L,E,g);if(!Array.isArray(w)){const m=g,A=+w;if(a===Ot&&([E,g]=da(E,g,A)),w=Xl(E,g,A),w[0]<=E&&(S=_l(E,g,A)),w[w.length-1]>=g)if(m>=g&&a===Ot){const x=_l(E,g,A);isFinite(x)&&(x>0?g=(Math.floor(g/x)+1)*x:x<0&&(g=(Math.ceil(g*-x)+1)/-x))}else w.pop()}for(var _=w.length,z=0,H=_;w[z]<=E;)++z;for(;w[H-1]>g;)--H;(z||H<_)&&(w=w.slice(z,H),_=H-z);var C=new Array(_+1),P;for(s=0;s<=_;++s)P=C[s]=[],P.x0=s>0?w[s-1]:E,P.x1=s<_?w[s]:g;if(isFinite(S)){if(S>0)for(s=0;s<b;++s)(u=L[s])!=null&&E<=u&&u<=g&&C[Math.min(_,Math.floor((u-E)/S))].push(d[s]);else if(S<0){for(s=0;s<b;++s)if((u=L[s])!=null&&E<=u&&u<=g){const m=Math.floor((E-u)*S);C[Math.min(_,m+(w[m]<=u))].push(d[s])}}}else for(s=0;s<b;++s)(u=L[s])!=null&&E<=u&&u<=g&&C[Kl(w,u,0,_)].push(d[s]);return C}return n.value=function(d){return arguments.length?(t=typeof d=="function"?d:Xt(d),n):t},n.domain=function(d){return arguments.length?(a=typeof d=="function"?d:Xt([d[0],d[1]]),n):a},n.thresholds=function(d){return arguments.length?(l=typeof d=="function"?d:Xt(Array.isArray(d)?va.call(d):d),n):l},n}function kl(t,a,l){const n=t.slice();return n[42]=a[l],n[43]=a,n[44]=l,n}function Vl(t,a,l){const n=t.slice();return n[42]=a[l],n}function xl(t){let a,l,n,d,s;return{c(){a=o("div"),l=o("div"),n=o("span"),d=y(t[13]),s=y(" >>"),this.h()},l(b){a=r(b,"DIV",{class:!0});var u=v(a);l=r(u,"DIV",{class:!0});var S=v(l);n=r(S,"SPAN",{class:!0});var L=v(n);d=I(L,t[13]),s=I(L," >>"),L.forEach(f),S.forEach(f),u.forEach(f),this.h()},h(){i(n,"class","mini-header-text"),i(l,"class","mini-header-content"),i(a,"class","mini-header")},m(b,u){me(b,a,u),e(a,l),e(l,n),e(n,d),e(n,s)},p:Ll,d(b){b&&f(a)}}}function Sl(t){let a,l,n=t[9].legend(t[17]).outerHTML+"";return{c(){a=o("div"),l=new Pl(!1),this.h()},l(d){a=r(d,"DIV",{id:!0});var s=v(a);l=Hl(s,!1),s.forEach(f),this.h()},h(){l.a=null,i(a,"id","legend")},m(d,s){me(d,a,s),l.m(n,a)},p(d,s){s[0]&512&&n!==(n=d[9].legend(d[17]).outerHTML+"")&&l.p(n)},d(d){d&&f(a)}}}function yl(t){let a,l,n,d,s=t[42].def+"",b,u,S,L,p,E,g,w="here",_,z,H=t[42].id.toLowerCase()+"",C,P,m;return{c(){a=o("div"),l=o("div"),n=o("div"),d=k(),b=y(s),u=k(),S=o("br"),L=k(),p=o("div"),E=y("Click "),g=o("a"),g.textContent=w,_=y(` for the 
                                `),z=o("span"),C=y(H),P=k(),m=y("report page."),this.h()},l(A){a=r(A,"DIV",{class:!0});var x=v(a);l=r(x,"DIV",{class:!0});var T=v(l);n=r(T,"DIV",{style:!0}),v(n).forEach(f),d=V(T),b=I(T,s),u=V(T),S=r(T,"BR",{}),L=V(T),p=r(T,"DIV",{class:!0});var N=v(p);E=I(N,"Click "),g=r(N,"A",{class:!0,href:!0,target:!0,rel:!0,style:!0,"data-svelte-h":!0}),Z(g)!=="svelte-gjrxnt"&&(g.textContent=w),_=I(N,` for the 
                                `),z=r(N,"SPAN",{style:!0});var F=v(z);C=I(F,H),P=V(F),F.forEach(f),m=I(N,"report page."),N.forEach(f),T.forEach(f),x.forEach(f),this.h()},h(){ee(n,"height","0.8em"),i(g,"class","link"),i(g,"href",ea+"/cobenefit?cobenefit="+t[42].id),i(g,"target","_blank"),i(g,"rel","noopener noreferrer"),ee(g,"color",ut(t[42].id)),ee(z,"color",ut(t[42].id)),i(p,"class","link-box svelte-1w6xccz"),i(l,"class","legend-description svelte-1w6xccz"),i(a,"class","legend-description-box svelte-1w6xccz")},m(A,x){me(A,a,x),e(a,l),e(l,n),e(l,d),e(l,b),e(l,u),e(l,S),e(l,L),e(l,p),e(p,E),e(p,g),e(p,_),e(p,z),e(z,C),e(z,P),e(p,m)},d(A){A&&f(a)}}}function Il(t){let a,l,n,d,s,b=t[42].label+"",u,S,L,p,E=t[12].has(t[42].id)?"▲":"▼",g,w,_=t[12].has(t[42].id),z,H,C;function P(){return t[24](t[42])}let m=_&&yl(t);return{c(){a=o("div"),l=o("div"),n=o("span"),d=k(),s=o("span"),u=y(b),L=k(),p=o("span"),g=y(E),w=k(),m&&m.c(),z=k(),this.h()},l(A){a=r(A,"DIV",{class:!0});var x=v(a);l=r(x,"DIV",{class:!0,style:!0});var T=v(l);n=r(T,"SPAN",{class:!0,style:!0}),v(n).forEach(f),d=V(T),s=r(T,"SPAN",{class:!0});var N=v(s);u=I(N,b),N.forEach(f),L=V(T),p=r(T,"SPAN",{class:!0});var F=v(p);g=I(F,E),F.forEach(f),T.forEach(f),w=V(x),m&&m.l(x),z=V(x),x.forEach(f),this.h()},h(){i(n,"class","legend-color svelte-1w6xccz"),ee(n,"background-color",ut(t[42].id)),i(s,"class",S="legend-text "+(t[12].has(t[42].id)?"expanded":"")+" svelte-1w6xccz"),i(p,"class","toggle-icon svelte-1w6xccz"),i(l,"class","legend-header svelte-1w6xccz"),ee(l,"cursor","pointer"),i(a,"class","legend-item svelte-1w6xccz")},m(A,x){me(A,a,x),e(a,l),e(l,n),e(l,d),e(l,s),e(s,u),e(l,L),e(l,p),e(p,g),e(a,w),m&&m.m(a,null),e(a,z),H||(C=Fl(l,"click",P),H=!0)},p(A,x){t=A,x[0]&4096&&S!==(S="legend-text "+(t[12].has(t[42].id)?"expanded":"")+" svelte-1w6xccz")&&i(s,"class",S),x[0]&4096&&E!==(E=t[12].has(t[42].id)?"▲":"▼")&&Ke(g,E),x[0]&4096&&(_=t[12].has(t[42].id)),_?m||(m=yl(t),m.c(),m.m(a,z)):m&&(m.d(1),m=null)},d(A){A&&f(a),m&&m.d(),H=!1,C()}}}function Al(t){let a=console.log("Missing key in plotSmallMult:",t[42].id)+"",l;return{c(){l=y(a)},l(n){l=I(n,a)},m(n,d){me(n,l,d)},p:Ll,d(n){n&&f(l)}}}function zl(t){let a,l,n=t[42].label+"",d,s,b,u,S=t[42],L,p=t[0][t[42].id]===void 0&&Al(t);const E=()=>t[25](u,S),g=()=>t[25](null,S);return{c(){a=o("div"),l=o("h3"),d=y(n),s=k(),p&&p.c(),b=k(),u=o("div"),L=k(),this.h()},l(w){a=r(w,"DIV",{class:!0});var _=v(a);l=r(_,"H3",{class:!0});var z=v(l);d=I(z,n),z.forEach(f),s=V(_),p&&p.l(_),b=V(_),u=r(_,"DIV",{class:!0}),v(u).forEach(f),L=V(_),_.forEach(f),this.h()},h(){i(l,"class","component-chart-title svelte-1w6xccz"),i(u,"class","plot svelte-1w6xccz"),i(a,"class","plot-container svelte-1w6xccz")},m(w,_){me(w,a,_),e(a,l),e(l,d),e(a,s),p&&p.m(a,null),e(a,b),e(a,u),E(),e(a,L)},p(w,_){t=w,t[0][t[42].id]===void 0?p?p.p(t,_):(p=Al(t),p.c(),p.m(a,b)):p&&(p.d(1),p=null),S!==t[42]&&(g(),S=t[42],E())},d(w){w&&f(a),p&&p.d(),g()}}}function ga(t){let a,l,n,d,s,b,u,S="SEF Report",L,p,E,g,w,_,z,H,C,P,m,A,x,T,N,F=Xe(t[5],t[16])+"",ie,oe,_e,Je,re,ae,Qe,ce,be=Xe(t[4],t[16])+"",$,Fe,X,Ze,Ee,we=Xe(t[6],t[16])+"",Ne,$e,c,q,U,De,ke,de,Ve,Kt='<p class="section-subtitle svelte-1w6xccz">Overview</p>',ht,se,K,xe,vt,pt,gt,Se,Jt="Each point in the chart below represents a UK data zone (LSOA).",mt,ye,Qt=`<div class="tooltip-wrapper"><img class="aggregation-icon" src="${qt}" alt="icon"/> <span class="tooltip-text">This chart uses per capita values. i.e. shows the cost/benefit per person in each AREA.</span></div>`,_t,Be,bt,j,Re,Et,wt,Ie,Zt="Scroll for zooming in and out.",Dt,Ae,$t=`<div class="tooltip-wrapper"><img class="aggregation-icon" src="${qt}" alt="icon"/> <span class="tooltip-text">These charts use per capita values. i.e. show the cost/benefit per person in each LAD.</span></div>`,kt,lt,ze,Vt,fe,Le,el='<p class="section-subtitle svelte-1w6xccz">By Co-benefits</p>',xt,te,B,ue,St,he,tl=t[13].toLowerCase()+"",yt,It,At,Ce,ll="Each plot shows the distribution of benefits or costs for each of the 11 co-benefits.",zt,Lt,Ct,ve,al='<p style="margin: 0 0 1rem 0;"><strong>Correlation ≠ Causation:</strong> The scatter plots represent modelled associations and should not be interpreted as direct causal relationships.</p> <p style="margin: 0 0 1rem 0;"><strong>Varying y-axis scales:</strong> The scatter plots have different scales on the y-axis due to the nature of each co-benefit.</p>',Mt,Me,sl=`<div class="tooltip-wrapper"><img class="aggregation-icon" src="${qt}" alt="icon"/> <span class="tooltip-text">These charts use per capita values. i.e. show the cost/benefit per person in each LAD.</span></div>`,Tt,G,Oe,nl="Co-benefits:",Pt,Ht,et,Ft,Nt,Te,pe,ne;a=new ql({});let Y=t[11]&&xl(t),W=t[9]&&Sl(t),Ue=dt(ft),R=[];for(let h=0;h<Ue.length;h+=1)R[h]=Il(Vl(t,Ue,h));let Ye=dt(ft),O=[];for(let h=0;h<Ye.length;h+=1)O[h]=zl(kl(t,Ye,h));return{c(){Rl(a.$$.fragment),l=k(),n=o("div"),d=o("div"),s=o("div"),b=o("div"),u=o("p"),u.textContent=S,L=k(),p=o("div"),E=o("h1"),g=y(t[15]),w=k(),_=o("p"),z=y(t[14]),H=k(),C=o("div"),P=o("div"),m=k(),A=o("div"),x=o("p"),T=y("Max value: "),N=o("strong"),ie=y(F),oe=y(`
                    (`),_e=y(t[7]),Je=y(")"),re=k(),ae=o("p"),Qe=y("Average value: "),ce=o("strong"),$=y(be),Fe=k(),X=o("p"),Ze=y("Min value: "),Ee=o("strong"),Ne=y(we),$e=y(`
                    (`),c=y(t[8]),q=y(")"),U=k(),Y&&Y.c(),De=k(),ke=o("div"),de=o("div"),Ve=o("div"),Ve.innerHTML=Kt,ht=k(),se=o("div"),K=o("div"),xe=o("h3"),vt=y(t[13]),pt=y(" against per capita co-benefit values (£, thousand)"),gt=k(),Se=o("p"),Se.textContent=Jt,mt=k(),ye=o("div"),ye.innerHTML=Qt,_t=k(),Be=o("div"),bt=k(),j=o("div"),Re=o("h3"),Et=y(t[13]),wt=k(),Ie=o("p"),Ie.textContent=Zt,Dt=k(),Ae=o("div"),Ae.innerHTML=$t,kt=k(),W&&W.c(),lt=k(),ze=o("div"),Vt=k(),fe=o("div"),Le=o("div"),Le.innerHTML=el,xt=k(),te=o("div"),B=o("div"),ue=o("h3"),St=y("Plotting "),he=o("span"),yt=y(tl),It=y(" against the gain/loss (£, thousand) per capita for each co-benefit"),At=k(),Ce=o("p"),Ce.textContent=ll,zt=k(),Lt=o("br"),Ct=k(),ve=o("div"),ve.innerHTML=al,Mt=k(),Me=o("div"),Me.innerHTML=sl,Tt=k(),G=o("div"),Oe=o("strong"),Oe.textContent=nl,Pt=o("br"),Ht=y(`Expand for detailed explanation
                    `),et=o("div"),Ft=k();for(let h=0;h<R.length;h+=1)R[h].c();Nt=k(),Te=o("div"),pe=o("div");for(let h=0;h<O.length;h+=1)O[h].c();this.h()},l(h){Ol(a.$$.fragment,h),l=V(h),n=r(h,"DIV",{class:!0});var M=v(n);d=r(M,"DIV",{class:!0});var D=v(d);s=r(D,"DIV",{class:!0});var J=v(s);b=r(J,"DIV",{class:!0});var at=v(b);u=r(at,"P",{class:!0,"data-svelte-h":!0}),Z(u)!=="svelte-3h7aqf"&&(u.textContent=S),L=V(at),p=r(at,"DIV",{class:!0});var st=v(p);E=r(st,"H1",{class:!0});var il=v(E);g=I(il,t[15]),il.forEach(f),w=V(st),_=r(st,"P",{class:!0});var ol=v(_);z=I(ol,t[14]),ol.forEach(f),st.forEach(f),at.forEach(f),H=V(J),C=r(J,"DIV",{class:!0});var rl=v(C);P=r(rl,"DIV",{class:!0}),v(P).forEach(f),rl.forEach(f),m=V(J),A=r(J,"DIV",{class:!0});var We=v(A);x=r(We,"P",{class:!0});var je=v(x);T=I(je,"Max value: "),N=r(je,"STRONG",{});var cl=v(N);ie=I(cl,F),cl.forEach(f),oe=I(je,`
                    (`),_e=I(je,t[7]),Je=I(je,")"),je.forEach(f),re=V(We),ae=r(We,"P",{class:!0});var Bt=v(ae);Qe=I(Bt,"Average value: "),ce=r(Bt,"STRONG",{style:!0});var dl=v(ce);$=I(dl,be),dl.forEach(f),Bt.forEach(f),Fe=V(We),X=r(We,"P",{class:!0});var qe=v(X);Ze=I(qe,"Min value: "),Ee=r(qe,"STRONG",{});var fl=v(Ee);Ne=I(fl,we),fl.forEach(f),$e=I(qe,`
                    (`),c=I(qe,t[8]),q=I(qe,")"),qe.forEach(f),We.forEach(f),J.forEach(f),D.forEach(f),U=V(M),Y&&Y.l(M),De=V(M),ke=r(M,"DIV",{class:!0});var ul=v(ke);de=r(ul,"DIV",{id:!0});var nt=v(de);Ve=r(nt,"DIV",{class:!0,"data-svelte-h":!0}),Z(Ve)!=="svelte-ll1i43"&&(Ve.innerHTML=Kt),ht=V(nt),se=r(nt,"DIV",{id:!0,class:!0});var it=v(se);K=r(it,"DIV",{class:!0});var ge=v(K);xe=r(ge,"H3",{class:!0});var Rt=v(xe);vt=I(Rt,t[13]),pt=I(Rt," against per capita co-benefit values (£, thousand)"),Rt.forEach(f),gt=V(ge),Se=r(ge,"P",{class:!0,"data-svelte-h":!0}),Z(Se)!=="svelte-1ozkrs5"&&(Se.textContent=Jt),mt=V(ge),ye=r(ge,"DIV",{class:!0,"data-svelte-h":!0}),Z(ye)!=="svelte-xpsz06"&&(ye.innerHTML=Qt),_t=V(ge),Be=r(ge,"DIV",{class:!0}),v(Be).forEach(f),ge.forEach(f),bt=V(it),j=r(it,"DIV",{class:!0});var le=v(j);Re=r(le,"H3",{class:!0});var hl=v(Re);Et=I(hl,t[13]),hl.forEach(f),wt=V(le),Ie=r(le,"P",{class:!0,"data-svelte-h":!0}),Z(Ie)!=="svelte-1ask2se"&&(Ie.textContent=Zt),Dt=V(le),Ae=r(le,"DIV",{class:!0,"data-svelte-h":!0}),Z(Ae)!=="svelte-1dxsuae"&&(Ae.innerHTML=$t),kt=V(le),W&&W.l(le),lt=V(le),ze=r(le,"DIV",{id:!0,class:!0}),v(ze).forEach(f),le.forEach(f),it.forEach(f),nt.forEach(f),ul.forEach(f),Vt=V(M),fe=r(M,"DIV",{id:!0});var ot=v(fe);Le=r(ot,"DIV",{class:!0,"data-svelte-h":!0}),Z(Le)!=="svelte-1av3fse"&&(Le.innerHTML=el),xt=V(ot),te=r(ot,"DIV",{id:!0,class:!0,style:!0});var rt=v(te);B=r(rt,"DIV",{id:!0,class:!0});var Q=v(B);ue=r(Q,"H3",{class:!0});var ct=v(ue);St=I(ct,"Plotting "),he=r(ct,"SPAN",{style:!0});var vl=v(he);yt=I(vl,tl),vl.forEach(f),It=I(ct," against the gain/loss (£, thousand) per capita for each co-benefit"),ct.forEach(f),At=V(Q),Ce=r(Q,"P",{class:!0,"data-svelte-h":!0}),Z(Ce)!=="svelte-1h97e3k"&&(Ce.textContent=ll),zt=V(Q),Lt=r(Q,"BR",{}),Ct=V(Q),ve=r(Q,"DIV",{id:!0,class:!0,"data-svelte-h":!0}),Z(ve)!=="svelte-11g4vkg"&&(ve.innerHTML=al),Mt=V(Q),Me=r(Q,"DIV",{class:!0,"data-svelte-h":!0}),Z(Me)!=="svelte-1ps2onq"&&(Me.innerHTML=sl),Tt=V(Q),G=r(Q,"DIV",{id:!0,class:!0});var Pe=v(G);Oe=r(Pe,"STRONG",{"data-svelte-h":!0}),Z(Oe)!=="svelte-1qu96kx"&&(Oe.textContent=nl),Pt=r(Pe,"BR",{}),Ht=I(Pe,`Expand for detailed explanation
                    `),et=r(Pe,"DIV",{style:!0}),v(et).forEach(f),Ft=V(Pe);for(let He=0;He<R.length;He+=1)R[He].l(Pe);Pe.forEach(f),Q.forEach(f),Nt=V(rt),Te=r(rt,"DIV",{id:!0,class:!0});var pl=v(Te);pe=r(pl,"DIV",{id:!0,class:!0});var gl=v(pe);for(let He=0;He<O.length;He+=1)O[He].l(gl);gl.forEach(f),pl.forEach(f),rt.forEach(f),ot.forEach(f),M.forEach(f),this.h()},h(){i(u,"class","page-subtitle svelte-1w6xccz"),i(E,"class","page-title svelte-1w6xccz"),i(_,"class","definition"),i(p,"class","title-container"),i(b,"class","header-text svelte-1w6xccz"),i(P,"class","plot svelte-1w6xccz"),i(C,"class","header-vis svelte-1w6xccz"),i(x,"class","definition-stat svelte-1w6xccz"),ee(ce,"color","#BD210E"),i(ae,"class","definition-stat svelte-1w6xccz"),i(X,"class","definition-stat svelte-1w6xccz"),i(A,"class","header-stats svelte-1w6xccz"),i(s,"class","header-content svelte-1w6xccz"),i(d,"class","section header svelte-1w6xccz"),i(Ve,"class","section-header"),i(xe,"class","component-title"),i(Se,"class","description"),i(ye,"class","aggregation-icon-container"),i(Be,"class","plot-dot svelte-1w6xccz"),i(K,"class","component column"),i(Re,"class","component-title"),i(Ie,"class","description"),i(Ae,"class","aggregation-icon-container2 svelte-1w6xccz"),i(ze,"id","map"),i(ze,"class","svelte-1w6xccz"),i(j,"class","component column"),i(se,"id","vis-block"),i(se,"class","svelte-1w6xccz"),i(de,"id","overview"),i(ke,"class","section"),i(Le,"class","section-header"),ee(he,"background-color","#555"),ee(he,"padding","0 1px"),ee(he,"color","#f9f9f9"),i(ue,"class","component-title"),i(Ce,"class","explanation"),i(ve,"id","se-disclaimer"),i(ve,"class","disclaimer-box svelte-1w6xccz"),i(Me,"class","aggregation-icon-container2 svelte-1w6xccz"),ee(et,"height","0.8em"),i(G,"id","main-legend"),i(G,"class","legend-box svelte-1w6xccz"),i(B,"id","se-title"),i(B,"class","svelte-1w6xccz"),i(pe,"id","multiple-plots"),i(pe,"class","svelte-1w6xccz"),i(Te,"id","multiple-comp"),i(Te,"class","svelte-1w6xccz"),i(te,"id","se-block"),i(te,"class","component svelte-1w6xccz"),ee(te,"margin-left","1rem"),i(fe,"id","compare"),i(n,"class","page-container")},m(h,M){Ul(a,h,M),me(h,l,M),me(h,n,M),e(n,d),e(d,s),e(s,b),e(b,u),e(b,L),e(b,p),e(p,E),e(E,g),e(p,w),e(p,_),e(_,z),e(s,H),e(s,C),e(C,P),t[21](P),e(s,m),e(s,A),e(A,x),e(x,T),e(x,N),e(N,ie),e(x,oe),e(x,_e),e(x,Je),e(A,re),e(A,ae),e(ae,Qe),e(ae,ce),e(ce,$),e(A,Fe),e(A,X),e(X,Ze),e(X,Ee),e(Ee,Ne),e(X,$e),e(X,c),e(X,q),e(n,U),Y&&Y.m(n,null),e(n,De),e(n,ke),e(ke,de),e(de,Ve),e(de,ht),e(de,se),e(se,K),e(K,xe),e(xe,vt),e(xe,pt),e(K,gt),e(K,Se),e(K,mt),e(K,ye),e(K,_t),e(K,Be),t[22](Be),e(se,bt),e(se,j),e(j,Re),e(Re,Et),e(j,wt),e(j,Ie),e(j,Dt),e(j,Ae),e(j,kt),W&&W.m(j,null),e(j,lt),e(j,ze),t[23](ze),e(n,Vt),e(n,fe),e(fe,Le),e(fe,xt),e(fe,te),e(te,B),e(B,ue),e(ue,St),e(ue,he),e(he,yt),e(ue,It),e(B,At),e(B,Ce),e(B,zt),e(B,Lt),e(B,Ct),e(B,ve),e(B,Mt),e(B,Me),e(B,Tt),e(B,G),e(G,Oe),e(G,Pt),e(G,Ht),e(G,et),e(G,Ft);for(let D=0;D<R.length;D+=1)R[D]&&R[D].m(G,null);e(te,Nt),e(te,Te),e(Te,pe);for(let D=0;D<O.length;D+=1)O[D]&&O[D].m(pe,null);t[26](n),ne=!0},p(h,M){if((!ne||M[0]&32)&&F!==(F=Xe(h[5],h[16])+"")&&Ke(ie,F),(!ne||M[0]&128)&&Ke(_e,h[7]),(!ne||M[0]&16)&&be!==(be=Xe(h[4],h[16])+"")&&Ke($,be),(!ne||M[0]&64)&&we!==(we=Xe(h[6],h[16])+"")&&Ke(Ne,we),(!ne||M[0]&256)&&Ke(c,h[8]),h[11]?Y?Y.p(h,M):(Y=xl(h),Y.c(),Y.m(n,De)):Y&&(Y.d(1),Y=null),h[9]?W?W.p(h,M):(W=Sl(h),W.c(),W.m(j,lt)):W&&(W.d(1),W=null),M[0]&266240){Ue=dt(ft);let D;for(D=0;D<Ue.length;D+=1){const J=Vl(h,Ue,D);R[D]?R[D].p(J,M):(R[D]=Il(J),R[D].c(),R[D].m(G,null))}for(;D<R.length;D+=1)R[D].d(1);R.length=Ue.length}if(M[0]&1){Ye=dt(ft);let D;for(D=0;D<Ye.length;D+=1){const J=kl(h,Ye,D);O[D]?O[D].p(J,M):(O[D]=zl(J),O[D].c(),O[D].m(pe,null))}for(;D<O.length;D+=1)O[D].d(1);O.length=Ye.length}},i(h){ne||(Yl(a.$$.fragment,h),ne=!0)},o(h){Wl(a.$$.fragment,h),ne=!1},d(h){h&&(f(l),f(n)),jl(a,h),t[21](null),Y&&Y.d(),t[22](null),W&&W.d(),t[23](null),ml(R,h),ml(O,h),t[26](null)}}}let Ge=400;function Xe(t,a){return a==="£"?`${a}${t}`:`${t} ${a}`}function ma(t,a,l){let n,d,s,b={},u,S,L,p=!1,E,g,w,_,z,H,C,{data:P}=a;const m=P.SEF;console.log("SEF ",m);const A=la.find(c=>c.id===m)?.label??m,x=aa.find(c=>c.id===m)?.def??m,T=sa.find(c=>c.id===m)?.description??m,N=na.find(c=>c.id===m)?.short_units??m,F=ia.find(c=>c.id===m)?.units??m;let ie,oe,_e=!1;const Je=["overview","compare"];function re(){const c=window.scrollY;l(11,_e=c>250);for(const q of Je){const U=document.getElementById(q);if(!U)continue;const De=U.getBoundingClientRect();if(De.top<=150&&De.bottom>=150)break}}Ml(()=>(window.addEventListener("scroll",re),re(),()=>window.removeEventListener("scroll",re))),Tl(()=>{window.removeEventListener("scroll",re)});async function ae(){u=await jt(oa(m)),console.log("totals",u),S=await jt(ra(m)),console.log("by cobens",S),L=await jt(ca()),console.log("per_capita_data",L),l(4,E=(bl(u,c=>c.val)??0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),console.log("Average Value: ",E),z=Jl(u,c=>c.val),l(7,_=z!==-1?u[z].Lookup_Value:"N/A"),l(5,g=(u[z]?.val??0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),C=Ql(u,c=>c.val),l(8,H=C!==-1?u[C].Lookup_Value:"N/A"),l(6,w=(u[C]?.val??0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),Dl.forEach(c=>{S[c]=+S[c]}),l(20,p=!0)}ae().then(()=>{l(9,ie=new ta(u,"LSOA",oe,"val",!1,"Lookup_Value",!1)),ie.initMap()});function Qe(){const c=bl(u,U=>U.val)??0,q=Zl(pa().thresholds(20).value(U=>U.val)(u),U=>U.length);d?.append(Ut({height:Ge/1.9,width:Ge*1.7,marginLeft:60,marginTop:30,marginRight:20,marginBottom:50,x:{label:`${F}`},y:{label:"No. of datazones",labelArrow:!1},style:{fontSize:"16px"},marks:[$l(u,ua({y:"count"},{x:{value:"val",thresholds:20},fill:"black",fillOpacity:.5,stroke:"black",srokeWidth:5})),Yt([c],{stroke:"#BD210E",strokeWidth:4,channels:{average:{value:c,label:"Average"}},tip:{format:{average:U=>`${U.toFixed(2)}`,x:!1}}}),Gt(u,{x:{value:c,thresholds:20},y:q+.1*q,r:5,fill:"#BD210E"}),Wt({label:`${F}`,labelArrow:!1,labelAnchor:"center"})]}))}function ce(){s?.append(Ut({height:Ge*1.5,width:Ge*2,marginLeft:60,marginTop:60,marginRight:10,marginBottom:60,x:{grid:!1},y:{grid:!0},style:{fontSize:"16px"},marks:[El([0],{stroke:"#333",strokeWidth:1.25}),Yt([0],{stroke:"#333",strokeWidth:.75}),Gt(u,{x:"val",y:c=>c.total_per_capita*1e3,fill:c=>c.total_per_capita<0?"#BD210E":"#242424",r:.9,fillOpacity:.75,channels:{location:{value:"Lookup_Value",label:"Location"},sef:{value:"val",label:`${F}`},value:{value:c=>c.total_per_capita*1e3,label:"Co-Benefit Value (£, thousand)"}},tip:{format:{location:!0,sef:!0,value:!0,x:!1,y:!1}}}),wl({label:"Per capita co-benefit value (£, thousand)",labelArrow:!1,labelAnchor:"center"}),Wt({label:`${F}`,labelArrow:!1,labelAnchor:"center"})]}))}function be(){Dl.forEach(c=>{let q;q=Ut({height:Ge,width:Ge,marginLeft:60,marginTop:10,marginRight:10,marginBottom:60,x:{label:null},y:{label:null},style:{fontSize:"12px"},marks:[El([0],{stroke:"#333",strokeWidth:1.25}),Yt([0],{stroke:"#333",strokeWidth:.75}),Gt(S.filter(U=>U.co_benefit_type==c),{x:"val",y:"total",fill:ut(c),fillOpacity:.5,r:.5,channels:{location:{value:"Lookup_Value",label:"Location"}},tip:{format:{location:!0,x:!1,y:!1}}}),wl({label:"Per capita co-benefit value (£, thousand)",labelArrow:!1,labelAnchor:"center"}),Wt({label:`${F}`,labelArrow:!1,labelAnchor:"center"})]}),b[c]?.append(q)})}let $=new Set;function Fe(c){$.has(c)?$.delete(c):$.add(c),l(12,$=new Set($))}function X(c){tt[c?"unshift":"push"](()=>{d=c,l(2,d)})}function Ze(c){tt[c?"unshift":"push"](()=>{s=c,l(3,s)})}function Ee(c){tt[c?"unshift":"push"](()=>{oe=c,l(10,oe)})}const we=c=>Fe(c.id);function Ne(c,q){tt[c?"unshift":"push"](()=>{b[q.id]=c,l(0,b)})}function $e(c){tt[c?"unshift":"push"](()=>{n=c,l(1,n)})}return t.$$set=c=>{"data"in c&&l(19,P=c.data)},t.$$.update=()=>{t.$$.dirty[0]&1048577&&(Object.values(b).forEach(c=>{c.firstChild?.remove()}),p&&(Qe(),ce(),be()))},[b,n,d,s,E,g,w,_,H,ie,oe,_e,$,A,x,T,N,F,Fe,P,p,X,Ze,Ee,we,Ne,$e]}class La extends Nl{constructor(a){super(),Bl(this,a,ma,ga,Cl,{data:19},null,[-1,-1])}}export{La as component};
