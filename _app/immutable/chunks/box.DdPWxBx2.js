import"./transform.BNP73y-7.js";import{_ as p,$ as N,a0 as q,a1 as M,a2 as A,a3 as I,a4 as C,a5 as y,a6 as L,a7 as R,a8 as S,r as b,a9 as d,d as T,aa as Y,M as $,U as D,c as Z,b as z,e as F,h as O,V as U,ab as V,K as X,ac as K,S as Q,ad as g,R as B,ae as G}from"./index.BijtlihT.js";import{c as H}from"./bin.Dm3GvWfY.js";import{b as J}from"./bar.RgVc80ea.js";import{d as P}from"./dot.o3Wq83Nt.js";function w(r,n=p){if(typeof r[Symbol.iterator]!="function")throw new TypeError("values is not iterable");let t=Array.from(r);const e=new Float64Array(t.length);n.length!==2&&(t=t.map(n),n=p);const a=(i,c)=>n(t[i],t[c]);let s,o;return r=Uint32Array.from(t,(i,c)=>c),r.sort(n===p?(i,c)=>N(t[i],t[c]):q(a)),r.forEach((i,c)=>{const u=a(i,s===void 0?i:s);u>=0?((s===void 0||u>0)&&(s=i,o=c),e[i]=o):e[i]=NaN}),e}function W(r={},n={}){const t=M(n),e=Object.entries(r).map(([a,s])=>{const o=A(a,n);if(o==null)throw new Error(`missing channel: ${a}`);const[i,c]=I(o);return{key:a,input:o,output:i,setOutput:c,map:j(s)}});return{...C(n,(a,s)=>{const o=y(a,t),i=e.map(({input:u})=>y(a,u)),c=e.map(({setOutput:u})=>u(new Array(a.length)));for(const u of s)for(const f of o?L(u,l=>o[l]).values():[u])e.forEach(({map:l},h)=>l.mapIndex(f,i[h],c[h]));return{data:a,facets:s}}),...Object.fromEntries(e.map(({key:a,output:s})=>[a,s]))}}function j(r){if(r==null)throw new Error("missing map");if(typeof r.mapIndex=="function")return r;if(typeof r.map=="function"&&R(r))return v(r);if(typeof r=="function")return m(S(r));switch(`${r}`.toLowerCase()){case"cumsum":return rt;case"rank":return m((n,t)=>w(n,e=>t[e]));case"quantile":return m((n,t)=>tt(n,e=>t[e]))}throw new Error(`invalid map: ${r}`)}function v(r){return console.warn("deprecated map interface; implement mapIndex instead."),{mapIndex:r.map.bind(r)}}function tt(r,n){const t=H(r,n)-1;return w(r,n).map(e=>e/t)}function m(r){return{mapIndex(n,t,e){const a=r(n,t);if(a.length!==n.length)throw new Error("map function returned a mismatched length");for(let s=0,o=n.length;s<o;++s)e[n[s]]=a[s]}}}const rt={mapIndex(r,n,t){let e=0;for(const a of r)t[a]=e+=n[a]}},nt={ariaLabel:"tick",fill:null,stroke:"currentColor"};class et extends ${constructor(n,t,e){super(n,t,e,nt),D(this,e)}render(n,t,e,a,s){return Z("svg:g",s).call(z,this,a,s).call(this._transform,this,t).call(o=>o.selectAll().data(n).enter().append("line").call(F,this).attr("x1",this._x1(t,e,a)).attr("x2",this._x2(t,e,a)).attr("y1",this._y1(t,e,a)).attr("y2",this._y2(t,e,a)).call(O,this,e).call(U,this,e,s)).node()}}class at extends et{constructor(n,t={}){const{x:e,y:a,inset:s=0,insetRight:o=s,insetLeft:i=s}=t;super(n,{y:{value:a,scale:"y"},x:{value:e,scale:"x",type:"band",optional:!0}},t),this.insetRight=d(o),this.insetLeft=d(i)}_transform(n,t,{y:e}){n.call(T,t,{y:e},0,Y)}_x1({x:n},{x:t},{marginLeft:e}){const{insetLeft:a}=this;return t&&n?s=>t[s]+a:e+a}_x2({x:n},{x:t},{width:e,marginRight:a}){const{insetRight:s}=this;return t&&n?o=>t[o]+n.bandwidth()-s:e-a-s}_y1(n,{y:t}){return e=>t[e]}_y2(n,{y:t}){return e=>t[e]}}function st(r,{y:n=b,...t}={}){return new at(r,{...t,y:n})}function pt(r,{y:n=b,x:t=null,r:e,fill:a="#ccc",fillOpacity:s,stroke:o="currentColor",strokeOpacity:i,strokeWidth:c=2,sort:u,...f}={}){const l=t!=null?B:G;return V(X(r,l({y1:x,y2:_},{x:t,y:n,stroke:o,strokeOpacity:i,...f})),J(r,l({y1:"p25",y2:"p75"},{x:t,y:n,fill:a,fillOpacity:s,...f})),st(r,l({y:"p50"},{x:t,y:n,stroke:o,strokeOpacity:i,strokeWidth:c,sort:u,...f})),P(r,W({y:ot},{x:t,y:n,z:t,r:e,stroke:o,strokeOpacity:i,...f})))}function ot(r){const n=x(r),t=_(r);return r.map(e=>e<n||e>t?e:NaN)}function x(r){const n=k(r)*2.5-E(r)*1.5;return K(r,t=>t>=n?t:NaN)}function _(r){const n=E(r)*2.5-k(r)*1.5;return Q(r,t=>t<=n?t:NaN)}function k(r){return g(r,.25)}function E(r){return g(r,.75)}export{pt as b};
