import"./F40_IDQw.js";import{P as U,L as Rn,Q as Zn,R as An,S as Dn,T as $,U as B,V as W,W as _,X as jn,Y as Kn,Z as Ln,_ as Vn,$ as k,a0 as Nn,a1 as qn,a2 as Hn,a3 as Pn,a4 as Qn,a5 as Un,a6 as Wn,a7 as z,a8 as tn,a9 as _n,aa as Jn,ab as C,ac as ne,H as rn,t as ee,ad as te,ae as re,af as oe,ag as ie,i as on,ah as ce,ai as se,aj as J,ak as fe,al as ae}from"./lkIfnYzw.js";function R(n,e){let t=0;if(e===void 0)for(let r of n)r!=null&&(r=+r)>=r&&++t;else{let r=-1;for(let o of n)(o=e(o,++r,n))!=null&&(o=+o)>=o&&++t}return t}function ue(n){return Math.max(1,Math.ceil(Math.log(R(n))/Math.LN2)+1)}function le(n,e,t){const r=R(n),o=U(n,.75)-U(n,.25);return r&&o?Math.ceil((t-e)/(2*o*Math.pow(r,-1/3))):1}function cn(n,e,t){const r=R(n),o=Rn(n);return r&&o?Math.ceil((t-e)*Math.cbrt(r)/(3.49*o)):1}function de(n={y:"count"},e={}){[n,e]=ye(n,e);const{x:t,y:r}=e;return me(be(t,e,on),null,null,r,n,Zn(e))}function he(n,e,t={}){if(t?.interval==null)return t;const{reduce:r=Vn}=t,o={filter:null};return t[e]!=null&&(o[e]=r),t[`${e}1`]!=null&&(o[`${e}1`]=r),t[`${e}2`]!=null&&(o[`${e}2`]=r),n(o,t)}function $e(n={}){return he(de,"y",An(n,"x"))}function me(n,e,t,r,{data:o=Kn,filter:i=Dn,sort:a,reverse:l,...f}={},u={}){n=nn(n),e=nn(e),f=Ie(f,u),o=an(o,on),a=a==null?void 0:sn("sort",a,u),i=i==null?void 0:fn("filter",i,u),r!=null&&$(f,"y","y1","y2")&&(r=null);const[s,d]=B(n),[c,h]=B(n),[m,I]=B(e),[g,y]=B(e),[A,D]=r!=null?[r,"y"]:[],[j,ln]=B(A),{x:dn,y:hn,z:v,fill:K,stroke:L,x1:mn,x2:yn,y1:bn,y2:xn,domain:ke,cumulative:Ce,thresholds:ve,interval:Ee,...In}=u,[pn,gn]=B(v),[V]=W(K),[N]=W(L),[Bn,Xn]=B(V),[Gn,Fn]=B(N);return{..."z"in u&&{z:pn||v},..."fill"in u&&{fill:Bn||K},..."stroke"in u&&{stroke:Gn||L},...jn(In,(b,E,Mn)=>{const O=ce(z(b,A),Mn?.[D]),F=z(b,v),M=z(b,V),Y=z(b,N),w=se(f,{z:F,fill:M,stroke:Y}),T=[],q=[],Yn=O&&ln([]),wn=F&&gn([]),zn=M&&Xn([]),Sn=Y&&Fn([]),H=n&&d([]),kn=n&&h([]),P=e&&I([]),Cn=e&&y([]),vn=Be(n,e,b);let En=0;for(const X of f)X.initialize(b);a&&a.initialize(b),i&&i.initialize(b);for(const X of E){const Q=[];for(const G of f)G.scope("facet",X);a&&a.scope("facet",X),i&&i.scope("facet",X);for(const[G,On]of J(X,w))for(const[Tn,S]of J(On,O))for(const[x,p]of vn(S))if(w&&(p.z=G),!(i&&!i.reduce(x,p))){Q.push(En++),q.push(o.reduceIndex(x,b,p)),O&&Yn.push(Tn),F&&wn.push(w===F?G:F[(x.length>0?x:S)[0]]),M&&zn.push(w===M?G:M[(x.length>0?x:S)[0]]),Y&&Sn.push(w===Y?G:Y[(x.length>0?x:S)[0]]),H&&(H.push(p.x1),kn.push(p.x2)),P&&(P.push(p.y1),Cn.push(p.y2));for(const $n of f)$n.reduce(x,p);a&&a.reduce(x,p)}T.push(Q)}return fe(T,a,l),{data:q,facets:T}}),...!$(f,"x")&&(s?{x1:s,x2:c,x:_(s,c)}:{x:dn,x1:mn,x2:yn}),...!$(f,"y")&&(m?{y1:m,y2:g,y:_(m,g)}:{y:hn,y1:bn,y2:xn}),...j&&{[D]:j},...Object.fromEntries(f.map(({name:b,output:E})=>[b,E]))}}function ye({cumulative:n,domain:e,thresholds:t,interval:r,...o},i){return[o,{cumulative:n,domain:e,thresholds:t,interval:r,...i}]}function be(n,{cumulative:e,domain:t,thresholds:r,interval:o},i){return n={...Ln(n)},n.domain===void 0&&(n.domain=t),n.cumulative===void 0&&(n.cumulative=e),n.thresholds===void 0&&(n.thresholds=r),n.interval===void 0&&(n.interval=o),n.value===void 0&&(n.value=i),n.thresholds=xe(n.thresholds,n.interval),n}function nn(n){if(n==null)return;const{value:e,cumulative:t,domain:r=k,thresholds:o}=n,i=a=>{let l=z(a,e),f;if(tn(l)||ge(o)){l=_n(l,Jn,Float64Array);let[s,d]=typeof r=="function"?r(l):r,c=typeof o=="function"&&!C(o)?o(l,s,d):o;typeof c=="number"&&(c=ne(s,d,c)),C(c)&&(r===k&&(s=c.floor(s),d=c.offset(c.floor(d))),c=c.range(s,c.offset(d))),f=c}else{l=rn(l);let[s,d]=typeof r=="function"?r(l):r,c=typeof o=="function"&&!C(o)?o(l,s,d):o;if(typeof c=="number")if(r===k){let h=ee(s,d,c);if(isFinite(h))if(h>0){let m=Math.round(s/h),I=Math.round(d/h);m*h<=s||--m,I*h>d||++I;let g=I-m+1;c=new Float64Array(g);for(let y=0;y<g;++y)c[y]=(m+y)*h}else if(h<0){h=-h;let m=Math.round(s*h),I=Math.round(d*h);m/h<=s||--m,I/h>d||++I;let g=I-m+1;c=new Float64Array(g);for(let y=0;y<g;++y)c[y]=(m+y)/h}else c=[s];else c=[s]}else c=te(s,d,c);else C(c)&&(r===k&&(s=c.floor(s),d=c.offset(c.floor(d))),c=c.range(s,c.offset(d)));f=c}const u=[];if(f.length===1)u.push([f[0],f[0]]);else for(let s=1;s<f.length;++s)u.push([f[s-1],f[s]]);return u.bin=(t<0?Ge:t>0?Xe:Z)(u,f,l),u};return i.label=Nn(e),i}function xe(n,e,t=en){if(n===void 0)return e===void 0?t:Un(e);if(typeof n=="string"){switch(n.toLowerCase()){case"freedman-diaconis":return le;case"scott":return cn;case"sturges":return ue;case"auto":return en}return Wn(n)}return n}function Ie(n,e){return qn(n,e,sn)}function sn(n,e,t){return Pn(n,e,t,fn)}function fn(n,e,t){return Qn(n,e,t,an)}function an(n,e){return Hn(n,e,pe)}function pe(n){switch(`${n}`.toLowerCase()){case"x":return Fe;case"x1":return Ye;case"x2":return we;case"y":return Me;case"y1":return ze;case"y2":return Se;case"z":return ae}throw new Error(`invalid bin reduce: ${n}`)}function en(n,e,t){return Math.min(200,cn(n,e,t))}function ge(n){return re(n)||oe(n)&&tn(n)}function Be(n,e,t){const r=n?.(t),o=e?.(t);return r&&o?function*(i){const a=r.bin(i);for(const[l,[f,u]]of r.entries()){const s=o.bin(a[l]);for(const[d,[c,h]]of o.entries())yield[s[d],{data:t,x1:f,y1:c,x2:u,y2:h}]}}:r?function*(i){const a=r.bin(i);for(const[l,[f,u]]of r.entries())yield[a[l],{data:t,x1:f,x2:u}]}:function*(i){const a=o.bin(i);for(const[l,[f,u]]of o.entries())yield[a[l],{data:t,y1:f,y2:u}]}}function Z(n,e,t){return e=rn(e),r=>{const o=n.map(()=>[]);for(const i of r)o[ie(e,t[i])-1]?.push(i);return o}}function Xe(n,e,t){const r=Z(n,e,t);return o=>{const i=r(o);for(let a=1,l=i.length;a<l;++a){const f=i[a-1],u=i[a];for(const s of f)u.push(s)}return i}}function Ge(n,e,t){const r=Z(n,e,t);return o=>{const i=r(o);for(let a=i.length-2;a>=0;--a){const l=i[a+1],f=i[a];for(const u of l)f.push(u)}return i}}function un(n,e){const t=(+n+ +e)/2;return n instanceof Date?new Date(t):t}const Fe={reduceIndex(n,e,{x1:t,x2:r}){return un(t,r)}},Me={reduceIndex(n,e,{y1:t,y2:r}){return un(t,r)}},Ye={reduceIndex(n,e,{x1:t}){return t}},we={reduceIndex(n,e,{x2:t}){return t}},ze={reduceIndex(n,e,{y1:t}){return t}},Se={reduceIndex(n,e,{y2:t}){return t}};export{de as b,R as c,$e as m,ue as t};
