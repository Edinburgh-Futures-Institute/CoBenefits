import{n as Q}from"./DRyxMU8n.js";import{N as L,O as U,P as V,M as R,Q as O,R as G,S as D,T as H,U as J,V as K,l as S,n as T,d as C,o as k,W as tt,E as w,q as P,X as et,Y as rt,Z as nt,_ as Z,$ as at,a0 as st,a1 as ot,a2 as it,a3 as lt,a4 as N,a5 as ct,i as $,a6 as _,a7 as W,D as ut,F as ft,a as ht,a8 as dt,a9 as Y,aa as mt,ab as pt,ac as z,ad as yt,C as vt}from"./DqZn9OX_.js";import{d as gt,e as xt,s as bt}from"./VOK_i5h5.js";function X(n,e=L){if(typeof n[Symbol.iterator]!="function")throw new TypeError("values is not iterable");let t=Array.from(n);const r=new Float64Array(t.length);e.length!==2&&(t=t.map(e),e=L);const a=(c,u)=>e(t[c],t[u]);let s,i;return n=Uint32Array.from(t,(c,u)=>u),n.sort(e===L?(c,u)=>U(t[c],t[u]):V(a)),n.forEach((c,u)=>{const o=a(c,s===void 0?c:s);o>=0?((s===void 0||o>0)&&(s=c,i=u),r[c]=i):r[c]=NaN}),r}const Mt={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function wt(n){return n.sort===void 0&&n.reverse===void 0?rt({channel:"-r"},n):n}class kt extends R{constructor(e,t={}){const{x:r,y:a,r:s,rotate:i,symbol:c=O,frameAnchor:u}=t,[o,l]=D(i,0),[h,f]=G(c),[m,y]=D(s,h==null?3:4.5);super(e,{x:{value:r,scale:"x",optional:!0},y:{value:a,scale:"y",optional:!0},r:{value:m,scale:"r",filter:H,optional:!0},rotate:{value:o,optional:!0},symbol:{value:h,scale:"auto",optional:!0}},wt(t),Mt),this.r=y,this.rotate=l,this.symbol=f,this.frameAnchor=J(u);const{channels:g}=this,{symbol:v}=g;if(v){const{fill:b,stroke:M}=g;v.hint={fill:b?b.value===v.value?"color":"currentColor":this.fill??"currentColor",stroke:M?M.value===v.value?"color":"currentColor":this.stroke??"none"}}}render(e,t,r,a,s){const{x:i,y:c}=t,{x:u,y:o,r:l,rotate:h,symbol:f}=r,{r:m,rotate:y,symbol:g}=this,[v,b]=K(this,a),M=g===O,q=l?void 0:m*m*Math.PI;return et(m)&&(e=[]),S("svg:g",s).call(T,this,a,s).call(C,this,{x:u&&i,y:o&&c}).call(I=>I.selectAll().data(e).enter().append(M?"circle":"path").call(k,this).call(M?A=>{A.attr("cx",u?d=>u[d]:v).attr("cy",o?d=>o[d]:b).attr("r",l?d=>l[d]:m)}:A=>{A.attr("transform",tt`translate(${u?d=>u[d]:v},${o?d=>o[d]:b})${h?d=>` rotate(${h[d]})`:y?` rotate(${y})`:""}`).attr("d",l&&f?d=>{const p=w();return f[d].draw(p,l[d]*l[d]*Math.PI),p}:l?d=>{const p=w();return g.draw(p,l[d]*l[d]*Math.PI),p}:f?d=>{const p=w();return f[d].draw(p,q),p}:(()=>{const d=w();return g.draw(d,q),d})())}).call(P,this,r)).node()}}function Wt(n,{x:e,y:t,...r}={}){return r.frameAnchor===void 0&&([e,t]=nt(e,t)),new kt(n,{...r,x:e,y:t})}function Xt(n,e={}){let{y:t,y1:r,y2:a}=e;t===void 0&&r===void 0&&a===void 0&&(e={...e,y:t=$});const s={};return t!=null&&(s.y=n),r!=null&&(s.y1=n),a!=null&&(s.y2=n),_t(s,e)}function _t(n={},e={}){const t=Z(e),r=Object.entries(n).map(([a,s])=>{const i=at(a,e);if(i==null)throw new Error(`missing channel: ${a}`);const[c,u]=st(i);return{key:a,input:i,output:c,setOutput:u,map:Ct(s)}});return{...ot(e,(a,s)=>{const i=N(a,t),c=r.map(({input:o})=>N(a,o)),u=r.map(({setOutput:o})=>o(new Array(a.length)));for(const o of s)for(const l of i?ct(o,h=>i[h]).values():[o])r.forEach(({map:h},f)=>h.mapIndex(l,c[f],u[f]));return{data:a,facets:s}}),...Object.fromEntries(r.map(({key:a,output:s})=>[a,s]))}}function Ct(n){if(n==null)throw new Error("missing map");if(typeof n.mapIndex=="function")return n;if(typeof n.map=="function"&&it(n))return $t(n);if(typeof n=="function")return E(lt(n));switch(`${n}`.toLowerCase()){case"cumsum":return Lt;case"rank":return E((e,t)=>X(e,r=>t[r]));case"quantile":return E((e,t)=>At(e,r=>t[r]))}throw new Error(`invalid map: ${n}`)}function $t(n){return console.warn("deprecated map interface; implement mapIndex instead."),{mapIndex:n.map.bind(n)}}function At(n,e){const t=gt(n,e)-1;return X(n,e).map(r=>r/t)}function E(n){return{mapIndex(e,t,r){const a=n(e,t);if(a.length!==e.length)throw new Error("map function returned a mismatched length");for(let s=0,i=e.length;s<i;++s)r[e[s]]=a[s]}}}const Lt={mapIndex(n,e,t){let r=0;for(const a of n)t[a]=r+=e[a]}},Et={ariaLabel:"tick",fill:null,stroke:"currentColor"};class j extends R{constructor(e,t,r){super(e,t,r,Et),ut(this,r)}render(e,t,r,a,s){return S("svg:g",s).call(T,this,a,s).call(this._transform,this,t).call(i=>i.selectAll().data(e).enter().append("line").call(k,this).attr("x1",this._x1(t,r,a)).attr("x2",this._x2(t,r,a)).attr("y1",this._y1(t,r,a)).attr("y2",this._y2(t,r,a)).call(P,this,r).call(ft,this,r,s)).node()}}class Rt extends j{constructor(e,t={}){const{x:r,y:a,inset:s=0,insetTop:i=s,insetBottom:c=s}=t;super(e,{x:{value:r,scale:"x"},y:{value:a,scale:"y",type:"band",optional:!0}},t),this.insetTop=_(i),this.insetBottom=_(c)}_transform(e,t,{x:r}){e.call(C,t,{x:r},W,0)}_x1(e,{x:t}){return r=>t[r]}_x2(e,{x:t}){return r=>t[r]}_y1({y:e},{y:t},{marginTop:r}){const{insetTop:a}=this;return t&&e?s=>t[s]+a:r+a}_y2({y:e},{y:t},{height:r,marginBottom:a}){const{insetBottom:s}=this;return t&&e?i=>t[i]+e.bandwidth()-s:r-a-s}}class St extends j{constructor(e,t={}){const{x:r,y:a,inset:s=0,insetRight:i=s,insetLeft:c=s}=t;super(e,{y:{value:a,scale:"y"},x:{value:r,scale:"x",type:"band",optional:!0}},t),this.insetRight=_(i),this.insetLeft=_(c)}_transform(e,t,{y:r}){e.call(C,t,{y:r},0,W)}_x1({x:e},{x:t},{marginLeft:r}){const{insetLeft:a}=this;return t&&e?s=>t[s]+a:r+a}_x2({x:e},{x:t},{width:r,marginRight:a}){const{insetRight:s}=this;return t&&e?i=>t[i]+e.bandwidth()-s:r-a-s}_y1(e,{y:t}){return r=>t[r]}_y2(e,{y:t}){return r=>t[r]}}function jt(n,{x:e=$,...t}={}){return new Rt(n,{...t,x:e})}function It(n,{y:e=$,...t}={}){return new St(n,{...t,y:e})}function Tt(n,e,t){var r=1e-8,a=e-1,s=t-1,i=0,c,u,o,l,h,f,m,y;if(n<=0)return 0;if(n>=1)return 1;for(c=Math.log(e/(e+t)),u=Math.log(t/(e+t)),o=Math.exp(e*c)/e,l=Math.exp(t*u)/t,m=o+l,n<o/m?f=Math.pow(e*m*n,1/e):f=1-Math.pow(t*m*(1-n),1/t),y=-x(e)-x(t)+x(e+t);i<10;i++){if(f===0||f===1)return f;if(h=qt(f,e,t)-n,o=Math.exp(a*Math.log(f)+s*Math.log(1-f)+y),l=h/o,f-=o=l/(1-.5*Math.min(1,l*(a/f-s/(1-f)))),f<=0&&(f=.5*(f+o)),f>=1&&(f=.5*(f+o+1)),Math.abs(o)<r*f&&i>0)break}return f}function qt(n,e,t){var r=n===0||n===1?0:Math.exp(x(e+t)-x(e)-x(t)+e*Math.log(n)+t*Math.log(1-n));return n<0||n>1?!1:n<(e+1)/(e+t+2)?r*B(n,e,t)/e:1-r*B(1-n,t,e)/t}function B(n,e,t){var r=1e-30,a=1,s=e+t,i=e+1,c=e-1,u=1,o=1-s*n/i,l,h,f,m;for(Math.abs(o)<r&&(o=r),o=1/o,m=o;a<=100&&(l=2*a,h=a*(t-a)*n/((c+l)*(e+l)),o=1+h*o,Math.abs(o)<r&&(o=r),u=1+h/u,Math.abs(u)<r&&(u=r),o=1/o,m*=o*u,h=-(e+a)*(s+a)*n/((e+l)*(i+l)),o=1+h*o,Math.abs(o)<r&&(o=r),u=1+h/u,Math.abs(u)<r&&(u=r),o=1/o,f=o*u,m*=f,!(Math.abs(f-1)<3e-7));a++);return m}function x(n){var e=0,t=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],r=1.000000000190015,a,s,i;for(i=(s=a=n)+5.5,i-=(a+.5)*Math.log(i);e<6;e++)r+=t[e]/++s;return Math.log(2.506628274631*r/a)-i}function Ot(n,e){var t=Tt(2*Math.min(n,1-n),.5*e,.5);return t=Math.sqrt(e*(1-t)/t),n>.5?t:-t}const Dt={ariaLabel:"linear-regression",fill:"currentColor",fillOpacity:.1,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Nt extends R{constructor(e,t={}){const{x:r,y:a,z:s,ci:i=.95,precision:c=4}=t;if(super(e,{x:{value:r,scale:"x"},y:{value:a,scale:"y"},z:{value:Z(t),optional:!0}},t,Dt),this.z=s,this.ci=+i,this.precision=+c,!(0<=this.ci&&this.ci<1))throw new Error(`invalid ci; not in [0, 1): ${i}`);if(!(this.precision>0))throw new Error(`invalid precision: ${c}`)}render(e,t,r,a,s){const{x:i,y:c,z:u}=r,{ci:o}=this;return S("svg:g",s).call(T,this,a,s).call(C,this,t).call(l=>l.selectAll().data(u?pt(e,u,this.z):[e]).enter().call(h=>h.append("path").attr("fill","none").call(k,this).call(z,this,{...r,fill:null,fillOpacity:null}).attr("d",f=>this._renderLine(f,i,c)).call(o&&!yt(this.fill)?f=>f.select(Yt).attr("stroke","none").call(k,this).call(z,this,{...r,stroke:null,strokeOpacity:null,strokeWidth:null}).attr("d",m=>this._renderBand(m,i,c)):()=>{}))).node()}}function Yt(){return this.parentNode.insertBefore(this.ownerDocument.createElementNS(Q.svg,"path"),this)}class zt extends Nt{constructor(e,t){super(e,t)}_renderBand(e,t,r){const{ci:a,precision:s}=this,[i,c]=Y(e,l=>t[l]),u=F(e,t,r),o=Bt(e,t,r,(1-a)/2,u);return bt().x(l=>l).y0(l=>o(l,-1)).y1(l=>o(l,1))(mt(i,c-s/2,s).concat(c))}_renderLine(e,t,r){const[a,s]=Y(e,c=>t[c]),i=F(e,t,r);return`M${a},${i(a)}L${s},${i(s)}`}}function Qt(n,{x:e=ht,y:t=$,stroke:r,fill:a=dt(r)?"currentColor":r,...s}={}){return new zt(n,xt({...s,x:e,y:t,fill:a,stroke:r}))}function F(n,e,t){let r=0,a=0,s=0,i=0;for(const l of n){const h=e[l],f=t[l];r+=h,a+=f,s+=h*f,i+=h*h}const c=n.length,u=(c*s-r*a)/(c*i-r*r),o=(a-u*r)/c;return l=>u*l+o}function Bt(n,e,t,r,a){const s=vt(n,l=>e[l])/n.length;let i=0,c=0;for(const l of n)i+=(e[l]-s)**2,c+=(t[l]-a(e[l]))**2;const u=Math.sqrt(c/(n.length-2)),o=Ot(r,n.length-2);return(l,h)=>{const f=a(l),m=u*Math.sqrt(1/n.length+(l-s)**2/i);return f+h*o*m}}export{Xt as a,jt as b,Wt as d,Qt as l,_t as m,It as t};
