import"./transform.Bxaw71Wc.js";import{q as U,d as Vt,b as Nt,h as O,c as B,e as W,f as qt,i as tt,j as Ht,k as Jt,l as Pt,n as Qt,o as Ut,u as Wt,s as te,t as ee,v as ne,w as re,x as C,y as se,z as ae,A as G,B as ce,C as et,D as ie,E as ot,F as oe,G as ue,H as S,I as fe,J as T,K as ut,L as le,M as he,N as ye,O as de,P as me,Q as xe,R as be,S as ft,T as lt,U as pe,V as Ie,W as ge,X as Be,Y as Xe,Z as we,_ as ht,$ as k,a0 as Me,a1 as ve,a2 as Ye,a3 as _e,a4 as Ge,a5 as nt,a6 as Fe,a7 as rt,a8 as st}from"./index.BB3F7tZ8.js";function D(e,t){let n=0;for(let r of e)r!=null&&(r=+r)>=r&&++n;return n}function Se(e){return Math.max(1,Math.ceil(Math.log(D(e))/Math.LN2)+1)}function Te(e,t,n){const r=D(e),s=U(e,.75)-U(e,.25);return r&&s?Math.ceil((n-t)/(2*s*Math.pow(r,-1/3))):1}function yt(e,t,n){const r=D(e),s=Vt(e);return r&&s?Math.ceil((n-t)*Math.cbrt(r)/(3.49*s)):1}function ke(e={y:"count"},t={}){[e,t]=ze(e,t);const{x:n,y:r}=t;return Re(Ae(n,t,C),null,null,r,e,Nt(t))}function Ce(e,t,n={}){if(n?.interval==null)return n;const{reduce:r=be}=n,s={filter:null};return n[t]!=null&&(s[t]=r),n[`${t}1`]!=null&&(s[`${t}1`]=r),n[`${t}2`]!=null&&(s[`${t}2`]=r),e(s,n)}function an(e={}){return Ce(ke,"y",se(e,"x"))}function Re(e,t,n,r,{data:s=Ht,filter:a=Jt,sort:c,reverse:u,...i}={},l={}){e=at(e),t=at(t),i=Oe(i,l),s=xt(s,C),c=c==null?void 0:dt("sort",c,l),a=a==null?void 0:mt("filter",a,l),r!=null&&O(i,"y","y1","y2")&&(r=null);const[f,y]=B(e),[o,h]=B(e),[d,x]=B(t),[p,m]=B(t),[$,Z]=r!=null?[r,"y"]:[],[K,It]=B($),{x:gt,y:Bt,z:R,fill:j,stroke:V,x1:Xt,x2:wt,y1:Mt,y2:vt,domain:We,cumulative:tn,thresholds:en,interval:nn,...Yt}=l,[_t,Gt]=B(R),[N]=W(j),[q]=W(V),[Ft,St]=B(N),[Tt,kt]=B(q);return{..."z"in l&&{z:_t||R},..."fill"in l&&{fill:Ft||j},..."stroke"in l&&{stroke:Tt||V},...qt(Yt,(b,z,Ct)=>{const A=ae(G(b,$),Ct?.[Z]),M=G(b,R),v=G(b,N),Y=G(b,q),_=ce(i,{z:M,fill:v,stroke:Y}),L=[],H=[],Rt=A&&It([]),zt=M&&Gt([]),At=v&&St([]),Lt=Y&&kt([]),J=e&&y([]),Ot=e&&h([]),P=t&&x([]),Dt=t&&m([]),Et=$e(e,t,b);let $t=0;for(const X of i)X.initialize(b);c&&c.initialize(b),a&&a.initialize(b);for(const X of z){const Q=[];for(const w of i)w.scope("facet",X);c&&c.scope("facet",X),a&&a.scope("facet",X);for(const[w,Zt]of et(X,_))for(const[Kt,F]of et(Zt,A))for(const[I,g]of Et(F))if(_&&(g.z=w),!(a&&!a.reduce(I,g))){Q.push($t++),H.push(s.reduceIndex(I,b,g)),A&&Rt.push(Kt),M&&zt.push(_===M?w:M[(I.length>0?I:F)[0]]),v&&At.push(_===v?w:v[(I.length>0?I:F)[0]]),Y&&Lt.push(_===Y?w:Y[(I.length>0?I:F)[0]]),J&&(J.push(g.x1),Ot.push(g.x2)),P&&(P.push(g.y1),Dt.push(g.y2));for(const jt of i)jt.reduce(I,g);c&&c.reduce(I,g)}L.push(Q)}return ie(L,c,u),{data:H,facets:L}}),...!O(i,"x")&&(f?{x1:f,x2:o,x:tt(f,o)}:{x:gt,x1:Xt,x2:wt}),...!O(i,"y")&&(d?{y1:d,y2:p,y:tt(d,p)}:{y:Bt,y1:Mt,y2:vt}),...K&&{[Z]:K},...Object.fromEntries(i.map(({name:b,output:z})=>[b,z]))}}function ze({cumulative:e,domain:t,thresholds:n,interval:r,...s},a){return[s,{cumulative:e,domain:t,thresholds:n,interval:r,...a}]}function Ae(e,{cumulative:t,domain:n,thresholds:r,interval:s},a){return e={...Pt(e)},e.domain===void 0&&(e.domain=n),e.cumulative===void 0&&(e.cumulative=t),e.thresholds===void 0&&(e.thresholds=r),e.interval===void 0&&(e.interval=s),e.value===void 0&&(e.value=a),e.thresholds=Le(e.thresholds,e.interval),e}function at(e){if(e==null)return;const{value:t,cumulative:n,domain:r=T,thresholds:s}=e,a=c=>{let u=G(c,t),i;if(ot(u)||Ee(s)){u=oe(u,ue,Float64Array);let[f,y]=typeof r=="function"?r(u):r,o=typeof s=="function"&&!S(s)?s(u,f,y):s;typeof o=="number"&&(o=fe(f,y,o)),S(o)&&(r===T&&(f=o.floor(f),y=o.offset(o.floor(y))),o=o.range(f,o.offset(y))),i=o}else{u=ut(u);let[f,y]=typeof r=="function"?r(u):r,o=typeof s=="function"&&!S(s)?s(u,f,y):s;if(typeof o=="number")if(r===T){let h=le(f,y,o);if(isFinite(h))if(h>0){let d=Math.round(f/h),x=Math.round(y/h);d*h<=f||--d,x*h>y||++x;let p=x-d+1;o=new Float64Array(p);for(let m=0;m<p;++m)o[m]=(d+m)*h}else if(h<0){h=-h;let d=Math.round(f*h),x=Math.round(y*h);d/h<=f||--d,x/h>y||++x;let p=x-d+1;o=new Float64Array(p);for(let m=0;m<p;++m)o[m]=(d+m)/h}else o=[f];else o=[f]}else o=he(f,y,o);else S(o)&&(r===T&&(f=o.floor(f),y=o.offset(o.floor(y))),o=o.range(f,o.offset(y)));i=o}const l=[];if(i.length===1)l.push([i[0],i[0]]);else for(let f=1;f<i.length;++f)l.push([i[f-1],i[f]]);return l.bin=(n<0?Ke:n>0?Ze:E)(l,i,u),l};return a.label=Qt(t),a}function Le(e,t,n=ct){if(e===void 0)return t===void 0?n:Ut(t);if(typeof e=="string"){switch(e.toLowerCase()){case"freedman-diaconis":return Te;case"scott":return yt;case"sturges":return Se;case"auto":return ct}return Wt(e)}return e}function Oe(e,t){return te(e,t,dt)}function dt(e,t,n){return ee(e,t,n,mt)}function mt(e,t,n){return ne(e,t,n,xt)}function xt(e,t){return re(e,t,De)}function De(e){switch(`${e}`.toLowerCase()){case"x":return je;case"x1":return Ne;case"x2":return qe;case"y":return Ve;case"y1":return He;case"y2":return Je;case"z":return ye}throw new Error(`invalid bin reduce: ${e}`)}function ct(e,t,n){return Math.min(200,yt(e,t,n))}function Ee(e){return de(e)||me(e)&&ot(e)}function $e(e,t,n){const r=e?.(n),s=t?.(n);return r&&s?function*(a){const c=r.bin(a);for(const[u,[i,l]]of r.entries()){const f=s.bin(c[u]);for(const[y,[o,h]]of s.entries())yield[f[y],{data:n,x1:i,y1:o,x2:l,y2:h}]}}:r?function*(a){const c=r.bin(a);for(const[u,[i,l]]of r.entries())yield[c[u],{data:n,x1:i,x2:l}]}:function*(a){const c=s.bin(a);for(const[u,[i,l]]of s.entries())yield[c[u],{data:n,y1:i,y2:l}]}}function E(e,t,n){return t=ut(t),r=>{const s=e.map(()=>[]);for(const a of r)s[xe(t,n[a])-1]?.push(a);return s}}function Ze(e,t,n){const r=E(e,t,n);return s=>{const a=r(s);for(let c=1,u=a.length;c<u;++c){const i=a[c-1],l=a[c];for(const f of i)l.push(f)}return a}}function Ke(e,t,n){const r=E(e,t,n);return s=>{const a=r(s);for(let c=a.length-2;c>=0;--c){const u=a[c+1],i=a[c];for(const l of u)i.push(l)}return a}}function bt(e,t){const n=(+e+ +t)/2;return e instanceof Date?new Date(n):n}const je={reduceIndex(e,t,{x1:n,x2:r}){return bt(n,r)}},Ve={reduceIndex(e,t,{y1:n,y2:r}){return bt(n,r)}},Ne={reduceIndex(e,t,{x1:n}){return n}},qe={reduceIndex(e,t,{x2:n}){return n}},He={reduceIndex(e,t,{y1:n}){return n}},Je={reduceIndex(e,t,{y2:n}){return n}},Pe={ariaLabel:"bar"};class pt extends Me{constructor(t,n,r={},s=Pe){super(t,n,r,s),ve(this,r),Ye(this,r)}render(t,n,r,s,a){const{rx:c,ry:u,rx1y1:i,rx1y2:l,rx2y1:f,rx2y2:y}=this,o=this._x(n,r,s),h=this._y(n,r,s),d=this._width(n,r,s),x=this._height(n,r,s);return _e("svg:g",a).call(Ge,this,s,a).call(this._transform,this,n).call(p=>p.selectAll().data(t).enter().call(i||l||f||y?m=>m.append("path").call(nt,this).call(Fe,o,h,it(o,d),it(h,x),this).call(rt,this,r):m=>m.append("rect").call(nt,this).attr("x",o).attr("width",d).attr("y",h).attr("height",x).call(st,"rx",c).call(st,"ry",u).call(rt,this,r))).node()}_x(t,{x:n},{marginLeft:r}){const{insetLeft:s}=this;return n?a=>n[a]+s:r+s}_y(t,{y:n},{marginTop:r}){const{insetTop:s}=this;return n?a=>n[a]+s:r+s}_width({x:t},{x:n},{marginRight:r,marginLeft:s,width:a}){const{insetLeft:c,insetRight:u}=this,i=n&&t?t.bandwidth():a-r-s;return Math.max(0,i-c-u)}_height({y:t},{y:n},{marginTop:r,marginBottom:s,height:a}){const{insetTop:c,insetBottom:u}=this,i=n&&t?t.bandwidth():a-r-s;return Math.max(0,i-c-u)}}function it(e,t){return typeof e=="function"&&typeof t=="function"?n=>e(n)+t(n):typeof e=="function"?n=>e(n)+t:typeof t=="function"?n=>e+t(n):e+t}class Qe extends pt{constructor(t,n={},r){const{x1:s,x2:a,y:c}=n;super(t,{x1:{value:s,scale:"x"},x2:{value:a,scale:"x"},y:{value:c,scale:"y",type:"band",optional:!0}},n,r)}_transform(t,n,{x:r}){t.call(ht,n,{x:r},0,0)}_x({x:t},{x1:n,x2:r},{marginLeft:s}){const{insetLeft:a}=this;return k(t)?s+a:c=>Math.min(n[c],r[c])+a}_width({x:t},{x1:n,x2:r},{marginRight:s,marginLeft:a,width:c}){const{insetLeft:u,insetRight:i}=this;return k(t)?c-s-a-u-i:l=>Math.max(0,Math.abs(r[l]-n[l])-u-i)}}class Ue extends pt{constructor(t,n={},r){const{x:s,y1:a,y2:c}=n;super(t,{y1:{value:a,scale:"y"},y2:{value:c,scale:"y"},x:{value:s,scale:"x",type:"band",optional:!0}},n,r)}_transform(t,n,{y:r}){t.call(ht,n,{y:r},0,0)}_y({y:t},{y1:n,y2:r},{marginTop:s}){const{insetTop:a}=this;return k(t)?s+a:c=>Math.min(n[c],r[c])+a}_height({y:t},{y1:n,y2:r},{marginTop:s,marginBottom:a,height:c}){const{insetTop:u,insetBottom:i}=this;return k(t)?c-s-a-u-i:l=>Math.max(0,Math.abs(r[l]-n[l])-u-i)}}function cn(e,t={}){return ft(t)||(t={...t,y:lt,x2:C}),new Qe(e,pe(Ie(ge(t))))}function on(e,t={}){return ft(t)||(t={...t,x:lt,y2:C}),new Ue(e,Be(Xe(we(t))))}export{ke as a,cn as b,on as c,an as m};
